(window.webpackJsonp=window.webpackJsonp||[]).push([["course"],{"202a":function(e,t,i){"use strict";i("e17f");var s=i("2241"),n=(i("e7e5"),i("d399")),r=(i("c5f6"),i("96cf"),i("3b8d")),a=(i("6762"),i("2fdb"),i("7f7f"),i("db72")),o=i("32e6"),c=i.n(o),u=i("2f62"),l=i("3ce7"),d=i("fd23"),p=i("bced"),h=i("4328"),f=i.n(h),m={components:{countDown:d.a,tagLink:p.a},props:{courseSet:{type:Object,default:function(){return{}}},seckillActivities:{type:Object,default:null}},data:function(){return{isEncryptionPlus:!1,mediaOpts:{},isCoverOpen:!1,isPlaying:!1,player:null,counting:!0,isEmpty:!1,tagData:{earnings:0,isShow:!1,link:"",className:"course-tag",minDirectRewardRatio:0},bindAgencyRelation:{}}},computed:Object(a.a)({},Object(u.d)(["DrpSwitch"]),{},Object(u.d)("course",{sourceType:function(e){return e.sourceType},selectedPlanId:function(e){return e.selectedPlanId},taskId:function(e){return e.taskId},details:function(e){return e.details},joinStatus:function(e){return e.joinStatus},user:function(e){return e.user}}),{textContent:function(){return this.mediaOpts.text}}),watch:{taskId:function(e,t){("course"!==this.$route.name||this.joinStatus)&&e>0&&this.initHead()}},created:function(){this.initHead(),this.showTagLink()},methods:{initHead:function(){["video","audio"].includes(this.sourceType)&&(window.scrollTo(0,0),this.initPlayer())},viewAudioDoc:function(){this.isCoverOpen=!0},hideAudioDoc:function(){this.isCoverOpen=!1},handlePlayer:function(){return this.isPlaying?this.player&&this.player.pause():this.player&&this.player.play()},getParams:function(){return this.joinStatus?{query:{courseId:this.selectedPlanId,taskId:this.taskId}}:{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{preview:1}}},initPlayer:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,i,r,a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$refs.video&&(this.$refs.video.innerHTML=""),e.next=3,l.a.getMedia(this.getParams()).catch((function(e){var t=Number(o.details.id);4040101==e.code&&o.$router.push({name:"login",query:{redirect:"/course/".concat(t)}}),n.a.fail(e.message)}));case 3:if(t=e.sent){e.next=7;break}return e.abrupt("return");case 7:if("video"!==t.mediaType||t.media.url){e.next=10;break}return Object(n.a)("ËØæÁ®ãÂÜÖÂÆπÂáÜÂ§á‰∏≠ÔºåËØ∑Á®çÂÄôÊü•Áúã"),e.abrupt("return");case 10:if(i=t.media.timeLimit,this.isEncryptionPlus=t.media.isEncryptionPlus,!t.media.isEncryptionPlus){e.next=15;break}return Object(n.a)("ËØ•ÊµèËßàÂô®‰∏çÊîØÊåÅ‰∫ëËßÜÈ¢ëÊí≠ÊîæÔºåËØ∑‰∏ãËΩΩApp"),e.abrupt("return");case 15:r=t.media,a={id:"course-detail__head--video",user:this.user,playlist:r.url,autoplay:!0,disableFullscreen:"audio"===this.sourceType,isAudio:"audio"===this.sourceType,strictMode:!r.supportMobile,pluck:{timelimit:i},resId:r.resId,disableDataUpload:!0},!this.joinStatus&&Number(this.details.tryLookable)||delete a.pluck,this.mediaOpts=Object.assign({text:t.media.text},a),this.$store.commit("UPDATE_LOADING_STATUS",!0),this.loadPlayerSDK().then((function(e){o.$store.commit("UPDATE_LOADING_STATUS",!1);var t=new e(a);t.on("playing",(function(){o.isPlaying=!0})),t.on("unablePlay",(function(){o.$refs.video.innerHTML="",s.a.alert({message:"ÂΩìÂâçÂÜÖÂÆπ‰∏çÊîØÊåÅËØ•ÊâãÊú∫ÊµèËßàÂô®ËßÇÁúãÔºåÂª∫ËÆÆÊÇ®‰ΩøÁî®Chrome„ÄÅSafariÊµèËßàÂô®ËßÇÁúã„ÄÇ"}).then((function(){}))})),t.on("paused",(function(){o.isPlaying=!1})),o.player=t}));case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),loadPlayerSDK:function(){if(!window.VideoPlayerSDK){var e="//service-cdn.qiqiuyun.net/js-sdk/video-player/sdk-v1.js?v="+Date.now()/1e3/60;return new Promise((function(t,i){c()(e,(function(e){e&&i(e),t(window.VideoPlayerSDK)}))}))}return Promise.resolve(window.VideoPlayerSDK)},expire:function(){this.counting=!1},sellOut:function(){this.isEmpty=!0,this.$emit("goodsEmpty")},showTagLink:function(){this.DrpSwitch?(this.initTagData(),this.getAgencyBindRelation()):this.tagData.isShow=!1},getAgencyBindRelation:function(){var e=this;l.a.getAgencyBindRelation().then((function(t){t.agencyId?(e.bindAgencyRelation=t,e.tagData.isShow=!0):e.tagData.isShow=!1}))},initTagData:function(){var e=this;l.a.getDrpSetting().then((function(t){e.drpSetting=t,e.tagData.minDirectRewardRatio=t.minDirectRewardRatio;var i={type:"course",id:e.details.id,merchant_id:e.drpSetting.merchantId};e.tagData.link=e.drpSetting.distributor_template_url+"?"+f.a.stringify(i);var s=e.drpSetting.minDirectRewardRatio/100*e.details.price;e.tagData.earnings=(Math.floor(100*s)/100).toFixed(2)}))}}},v=i("a6c2"),y=Object(v.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"course-detail__head pos-rl",attrs:{id:"course-detail__head"}},[e.textContent?i("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(e.sourceType)&&!e.isEncryptionPlus&&!e.isCoverOpen,expression:"['audio'].includes(sourceType) && !isEncryptionPlus && !isCoverOpen"}],staticClass:"course-detail__nav--btn",on:{click:e.viewAudioDoc}},[e._v("ÊñáÁ®ø")]):e._e(),e.textContent?i("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(e.sourceType)&&!e.isEncryptionPlus,expression:"['audio'].includes(sourceType) && !isEncryptionPlus"}],staticClass:"course-detail__nav--cover web-view",class:{opened:e.isCoverOpen}},[i("div",{staticClass:"media-text",domProps:{innerHTML:e._s(e.textContent)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isCoverOpen,expression:"isCoverOpen"}],staticClass:"course-detail__nav--cover-control",on:{click:e.handlePlayer}},[i("i",{staticClass:"h5-icon",class:e.isPlaying?"h5-icon-zanting":"h5-icon-bofang"})]),i("div",{staticClass:"course-detail__nav--cover-close-btn",on:{click:e.hideAudioDoc}},[i("i",{staticClass:"van-icon van-icon-arrow van-nav-bar__arrow"})])]):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"img"===e.sourceType||e.isEncryptionPlus,expression:"sourceType === 'img' || isEncryptionPlus"}],staticClass:"course-detail__head--img",attrs:{id:"course-detail__head--img"}},[e.courseSet.cover?i("img",{attrs:{src:e.courseSet.cover.large,alt:""}}):e._e(),e.seckillActivities&&"ongoing"===e.seckillActivities.status&&e.counting&&!e.isEmpty?i("countDown",{attrs:{activity:e.seckillActivities},on:{timesUp:e.expire,sellOut:e.sellOut}}):e._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:["video","audio"].includes(e.sourceType)&&!e.isEncryptionPlus,expression:"['video', 'audio'].includes(sourceType) && !isEncryptionPlus"}],ref:"video",attrs:{id:"course-detail__head--video"}}),i("tagLink",{attrs:{"tag-data":e.tagData}})],1)}),[],!1,null,null,null);t.a=y.exports},"28a0":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},3022:function(e,t,i){(function(e){var s=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},s=0;s<t.length;s++)i[t[s]]=Object.getOwnPropertyDescriptor(e,t[s]);return i},n=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(o(arguments[i]));return t.join(" ")}i=1;for(var s=arguments,r=s.length,a=String(e).replace(n,(function(e){if("%%"===e)return"%";if(i>=r)return e;switch(e){case"%s":return String(s[i++]);case"%d":return Number(s[i++]);case"%j":try{return JSON.stringify(s[i++])}catch(e){return"[Circular]"}default:return e}})),c=s[i];i<r;c=s[++i])m(c)||!w(c)?a+=" "+c:a+=" "+o(c);return a},t.deprecate=function(i,s){if(void 0!==e&&!0===e.noDeprecation)return i;if(void 0===e)return function(){return t.deprecate(i,s).apply(this,arguments)};var n=!1;return function(){if(!n){if(e.throwDeprecation)throw new Error(s);e.traceDeprecation,n=!0}return i.apply(this,arguments)}};var r,a={};function o(e,i){var s={seen:[],stylize:u};return arguments.length>=3&&(s.depth=arguments[2]),arguments.length>=4&&(s.colors=arguments[3]),f(i)?s.showHidden=i:i&&t._extend(s,i),g(s.showHidden)&&(s.showHidden=!1),g(s.depth)&&(s.depth=2),g(s.colors)&&(s.colors=!1),g(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=c),l(s,e,s.depth)}function c(e,t){var i=o.styles[t];return i?"["+o.colors[i][0]+"m"+e+"["+o.colors[i][1]+"m":e}function u(e,t){return e}function l(e,i,s){if(e.customInspect&&i&&x(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var n=i.inspect(s,e);return y(n)||(n=l(e,n,s)),n}var r=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return v(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,i);if(r)return r;var a=Object.keys(i),o=function(e){var t={};return e.forEach((function(e,i){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(i)),k(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(i);if(0===a.length){if(x(i)){var c=i.name?": "+i.name:"";return e.stylize("[Function"+c+"]","special")}if(b(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(_(i))return e.stylize(Date.prototype.toString.call(i),"date");if(k(i))return d(i)}var u,w="",C=!1,T=["{","}"];return h(i)&&(C=!0,T=["[","]"]),x(i)&&(w=" [Function"+(i.name?": "+i.name:"")+"]"),b(i)&&(w=" "+RegExp.prototype.toString.call(i)),_(i)&&(w=" "+Date.prototype.toUTCString.call(i)),k(i)&&(w=" "+d(i)),0!==a.length||C&&0!=i.length?s<0?b(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special"):(e.seen.push(i),u=C?function(e,t,i,s,n){for(var r=[],a=0,o=t.length;a<o;++a)S(t,String(a))?r.push(p(e,t,i,s,String(a),!0)):r.push("");return n.forEach((function(n){n.match(/^\d+$/)||r.push(p(e,t,i,s,n,!0))})),r}(e,i,s,o,a):a.map((function(t){return p(e,i,s,o,t,C)})),e.seen.pop(),function(e,t,i){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}(u,w,T)):T[0]+w+T[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,i,s,n,r){var a,o,c;if((c=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),S(s,n)||(a="["+n+"]"),o||(e.seen.indexOf(c.value)<0?(o=m(i)?l(e,c.value,null):l(e,c.value,i-1)).indexOf("\n")>-1&&(o=r?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),g(a)){if(r&&n.match(/^\d+$/))return o;(a=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+o}function h(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===C(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===C(e)}function k(e){return w(e)&&("[object Error]"===C(e)||e instanceof Error)}function x(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.debuglog=function(i){return g(r)&&(r=Object({NODE_ENV:"production",VUE_APP_H5_BASE_API:"/h5/h5/",VUE_APP_ADMIN_BASE_API:"/h5/admin/",BASE_URL:"/h5/"}).NODE_DEBUG||""),i=i.toUpperCase(),a[i]||(new RegExp("\\b"+i+"\\b","i").test(r)?(e.pid,a[i]=function(){t.format.apply(t,arguments)}):a[i]=function(){}),a[i]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=k,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=i("d60a"),t.log=function(){},t.inherits=i("28a0"),t._extend=function(e,t){if(!t||!w(t))return e;for(var i=Object.keys(t),s=i.length;s--;)e[i[s]]=t[i[s]];return e};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var i=new Error("Promise was rejected with a falsy value");i.reason=e,e=i}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(T&&e[T]){var t;if("function"!=typeof(t=e[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,i,s=new Promise((function(e,s){t=e,i=s})),n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);n.push((function(e,s){e?i(e):t(s)}));try{e.apply(this,n)}catch(e){i(e)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),T&&Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,s(e))},t.promisify.custom=T,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function i(){for(var i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);var n=i.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var r=this,a=function(){return n.apply(r,arguments)};t.apply(this,i).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(O,t,a)}))}return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),Object.defineProperties(i,s(t)),i}}).call(this,i("f28c"))},"32e6":function(e,t){function i(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function s(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,n){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},a.type=t.type||"text/javascript",a.charset=t.charset||"utf8",a.async=!("async"in t)||!!t.async,a.src=e,t.attrs&&function(e,t){for(var i in t)e.setAttribute(i,t[i])}(a,t.attrs),t.text&&(a.text=""+t.text),("onload"in a?i:s)(a,n),a.onload||i(a,n),r.appendChild(a)}},d60a:function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},fd4a:function(e,t,i){"use strict";i.r(t),i("e7e5");var s=i("d399"),n=i("db72"),r=(i("e17f"),i("2241")),a=(i("96cf"),i("3b8d")),o=(i("c5f6"),i("d0b2")),c=i("b127"),u=i("202a"),l=i("faa5"),d=i("410d"),p=i("2f62"),h={components:{service:d.a},filters:{filterTime:function(e){var t=new Date(e),i=t.getFullYear(),s="0".concat(t.getMonth()).slice(-2),n="0".concat(t.getDate()).slice(-2);return"".concat(i,"-").concat(s,"-").concat(n)}},data:function(){return{items:[],isFree:!1}},watch:{selectedPlanId:{immediate:!0,handler:function(e){var t=this;this.items=this.details.courses.map((function(e,i){return t.$set(e,"active",!1),e.id===t.details.id&&(e.active=!0),e}))}},learnExpiryHtml:{immediate:!0,handler:function(e){var t=this.details.learningExpiryDate,i=t.expiryStartDate.slice(0,10),s=t.expiryEndDate.slice(0,10);this.$emit("getLearnExpiry",{val:e,startDateStr:i,endDateStr:s})}}},computed:Object(n.a)({},Object(p.d)("course",{details:function(e){return e.details},selectedPlanId:function(e){return e.selectedPlanId},joinStatus:function(e){return e.joinStatus}}),{},Object(p.d)(["courseSettings","vipSwitch"]),{learnExpiryHtml:function(){var e=this.details.member,t=this.details.learningExpiryDate,i=t.expiryMode;if(e)return"forever"==i?"Ê∞∏‰πÖÊúâÊïà":0!=e.deadline?e.deadline.slice(0,10)+"‰πãÂâçÂèØÂ≠¶‰π†":"Ê∞∏‰πÖÊúâÊïà";switch(i){case"forever":return"Ê∞∏‰πÖÊúâÊïà";case"end_date":return t.expiryEndDate.slice(0,10)+"‰πãÂâçÂèØÂ≠¶‰π†";case"days":return t.expiryDays+"Â§©ÂÜÖÂèØÂ≠¶‰π†";case"date":return'<div class = "mt5">ÂºÄËØæÊó•ÊúüÔºö'+t.expiryStartDate.slice(0,10)+"&nbsp;&nbsp;&nbsp;Êà™Ê≠¢Êó•ÊúüÔºö"+t.expiryEndDate.slice(0,10)+"</div>"}},showStudent:function(){return!this.courseSettings||Number(this.courseSettings.show_student_num_enabled)},defaultPlan:function(){return 1===this.items.length&&!this.items[0].title},isDiscount:function(){if(!this.details.courseSet)return!1;var e=this.details.courseSet.discount;if(""!==e){var t=Number(e);return 10!==t&&(0===t||t)}}}),methods:Object(n.a)({},Object(p.b)("course",["getCourseLessons"]),{handleClick:function(e,t){this.$router.push({path:"/course/".concat(e.id)})},filterPrice:function(){var e=this.details;return Number(e.isFree)||"0.00"===e.price?(this.isFree=!0,"ÂÖçË¥π"):(this.isFree=!1,"¬•".concat(e.price))}})},f=i("a6c2"),m=Object(f.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("e-panel",{attrs:{title:e.details.courseSet.title}},[i("div",{staticClass:"course-detail__plan-price"},[i("span",{class:{isFree:e.isFree}},[e._v(e._s(e.filterPrice())+"\n        "),e.isDiscount?i("span",{staticClass:"original-price ml10"},[e._v("Âéü‰ª∑ÔºöÔø•"+e._s(e.details.originPrice))]):e._e()]),e.showStudent?i("span",{staticClass:"plan-price__student-num"},[e._v(e._s(e.details.studentNum)+"‰∫∫Âú®Â≠¶")]):e._e()])]),e.defaultPlan?e._e():i("ul",{staticClass:"course-detail__plan"},e._l(e.items,(function(t,s){return t.title?i("li",{class:{active:t.active},on:{click:function(i){return e.handleClick(t,s)}}},[e._v(e._s(t.title))]):e._e()})),0),i("div",{staticClass:"course-detail__validity"},[e.details.vipLevel&&e.vipSwitch?i("div",{staticClass:"mb15"},[i("span",{staticClass:"mr20"},[e._v("‰ºöÂëòÂÖçË¥π")]),i("img",{staticClass:"vipIcon",attrs:{src:e.details.vipLevel.icon}}),i("router-link",{staticClass:"color-primary",attrs:{to:{path:"/vip",query:{id:e.details.vipLevel.id}}}},[e._v("\n        "+e._s(e.details.vipLevel.name)+"ÂÖçË¥πÂ≠¶")])],1):e._e(),e.details.services.length?i("service",{attrs:{services:e.details.services}}):e._e(),i("div",[i("span",{staticClass:"mr20"},[e._v("Â≠¶‰π†ÊúâÊïàÊúü")]),i("span",{staticClass:"dark",domProps:{innerHTML:e._s(e.learnExpiryHtml)}})]),0!=e.details.buyExpiryTime?i("div",{staticClass:"mt5"},[i("span",{staticClass:"mr20"},[e._v("Ë¥≠‰π∞Êà™Ê≠¢Êó•Êúü")]),i("span",{staticClass:"validity orange"},[e._v(e._s(e._f("filterTime")(e.details.buyExpiryTime)))])]):e._e()],1)],1)}),[],!1,null,null,null).exports,v={name:"Teacher",props:["teacherInfo"]},y=Object(f.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("e-panel",{attrs:{title:"ÊïôÂ∏à‰ªãÁªç"}},[e._l(e.teacherInfo,(function(t){return[i("div",{staticClass:"teacher-content"},[i("img",{staticClass:"avatar-img",attrs:{src:t.avatar.large}}),i("div",{staticClass:"teacher-cell"},[i("span",{staticClass:"dark font-family-PFM"},[e._v(e._s(t.nickname))]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.title,expression:"item.title"}],staticClass:"text-content"},[e._v(e._s(t.title))])])])]}))],2)}),[],!1,null,null,null).exports,g={name:"SwiperDirectory",props:{item:{type:Array,default:function(){return[]}},slideIndex:{type:Number,default:0},hasChapter:{type:Boolean,default:!0}},data:function(){return{current:this.slideIndex||0}},watch:{slideIndex:function(e,t){e!=t&&(this.current=e||0)}},methods:{changeChapter:function(e){this.current=e,this.$emit("changeChapter",e)},handleChapter:function(e){this.$refs.chapterSwipe.swipeTo(e)}}},b=Object(f.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"swiper-directory"},[i("van-swipe",{ref:"chapterSwipe",attrs:{"show-indicators":!1,loop:!1,touchable:!0,width:265,"initial-swipe":e.slideIndex},on:{change:e.changeChapter}},e._l(e.item,(function(t,s){return i("van-swipe-item",{key:s},[0==t.isExist?i("div",{staticClass:"chapter nochapter",class:"swiper-directory-active",on:{click:function(t){return e.handleChapter(s)}}},[i("i",{staticClass:"iconfont icon-wuzhangjieliang"}),e._v("\n        Êó†Á´†ËäÇ\n      ")]):e._e(),1==t.isExist?i("div",{staticClass:"chapter haschapter",class:[e.current===s?"swiper-directory-active":""],on:{click:function(t){return e.handleChapter(s)}}},[i("p",{staticClass:"chapter-title text-overflow"},[e._v("Á¨¨"+e._s(t.number)+e._s(e.hasChapter?"Á´†":"ËäÇ")+"Ôºö"+e._s(t.title))]),i("p",{staticClass:"chapter-des text-overflow"},[e._v(e._s(e.hasChapter?"ËäÇ("+t.unitNum+")":"")+" ËØæÊó∂("+e._s(t.lessonNum)+") Â≠¶‰π†‰ªªÂä°("+e._s(t.tasksNum)+")")])]):e._e()])})),1)],1)}),[],!1,null,null,null).exports,w={name:"UtilDirectory",props:{util:{type:Object,default:function(){}}}},_=Object(f.a)(w,(function(){var e=this.$createElement,t=this._self._c||e;return 1==this.util.isExist?t("div",{staticClass:"util-directory text-overflow"},[this._v("\n  Á¨¨"+this._s(this.util.number)+"ËäÇÔºö"+this._s(this.util.title)+"\n")]):this._e()}),[],!1,null,null,null).exports,k=i("d863"),x={name:"LessonDirectory",mixins:[k.a],props:{lesson:{type:Array,default:function(){return[]}},errorMsg:{type:String,default:""},taskId:{type:Number,default:-1},taskNumber:{type:Number,default:-1},unitNum:{type:Number,default:-1}},data:function(){return{currentTask:""}},watch:{taskId:{handler:"getTaskId",immediate:!0}},computed:Object(n.a)({},Object(p.d)("course",{details:function(e){return e.details},joinStatus:function(e){return e.joinStatus},selectedPlanId:function(e){return e.selectedPlanId}}),{hasLesson:function(){return this.lesson.length>0},isNoData:function(){return 0===this.taskNumber&&0===this.unitNum}}),methods:Object(n.a)({},Object(p.c)("course",{setSourceType:l.p}),{getTaskId:function(){this.currentTask=this.taskId},doubleLine:function(e){if(e.type)return"live"===e.type},showTask:function(e,t){var i=!0;return null==e.mode&&0==t&&(i=!1),"lesson"==e.mode&&(i=!1),i},lessonCellClick:function(e){if(this.errorMsg)this.$emit("showDialog");else if("create"!==e.status){var t={id:e.id};this.$store.commit("course/".concat(l.f),{nextTask:t}),!this.details.allowAnonymousPreview&&this.$router.push({name:"login",query:{redirect:this.redirect}}),this.joinStatus&&this.showTypeDetail(e)}else Object(s.a)("Êï¨ËØ∑ÊúüÂæÖ")},showTypeDetail:function(e){if("published"===e.status)switch(e.type){case"video":"self"===e.mediaSource?this.setSourceType({sourceType:"video",taskId:e.id}):Object(s.a)("ÊöÇ‰∏çÊîØÊåÅÊ≠§Á±ªÂûã");break;case"audio":this.setSourceType({sourceType:"audio",taskId:e.id});break;case"text":case"ppt":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:e.id,type:e.type}});break;case"live":var t=new Date,i=new Date(1e3*e.endTime),n=(new Date(1e3*e.startTime),!1);if(t>i){if("videoGenerated"==e.activity.replayStatus)return void("self"===e.mediaSource?this.setSourceType({sourceType:"video",taskId:e.id}):Object(s.a)("ÊöÇ‰∏çÊîØÊåÅÊ≠§Á±ªÂûã"));if("ungenerated"==e.activity.replayStatus)return void Object(s.a)("ÊöÇÊó†ÂõûÊîæ");n=!0}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:e.id,type:e.type,title:e.title,replay:n}});break;case"testpaper":var r=e.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:r,targetId:e.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.$route.params.id,taskId:e.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.$route.params.id,taskId:e.id}});break;default:Object(s.a)("ÊöÇ‰∏çÊîØÊåÅÊ≠§Á±ªÂûã")}else Object(s.a)("Êï¨ËØ∑ÊúüÂæÖ")},iconfont:function(e){switch(e.type){case"audio":return"icon-yinpin";case"doc":return"icon-wendang";case"exercise":return"icon-lianxi";case"flash":return"icon-flash";case"homework":return"icon-zuoye";case"live":return"icon-zhibo";case"ppt":return"icon-ppt";case"discuss":return"icon-taolun";case"testpaper":return"icon-kaoshi";case"text":return"icon-tuwen";case"video":return"icon-shipin";case"download":return"icon-xiazai";default:return""}},studyStatus:function(e){if(e.lock)return"icon-suo";if(null==e.result)return"icon-weixuexi";switch(e.result.status){case"finish":return"icon-yiwanchengliang";case"start":return"icon-weiwancheng";default:return""}},liveClass:function(e){if("published"!=e.status||"live"!=e.type)return"nopublished";var t=(new Date).getTime();return new Date(1e3*e.startTime),t>new Date(1e3*e.endTime)?"ungenerated"===e.activity.replayStatus?"end":"back":"play"}})},C=Object(f.a)(x,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._l(e.lesson,(function(t,s){return e.hasLesson?i("div",{key:s,staticClass:"lesson-directory"},[i("div",{staticClass:"lesson-title",class:{"zb-ks":e.doubleLine(t.tasks[t.index])},attrs:{id:t.tasks[t.index].id},on:{click:function(i){return e.lessonCellClick(t.tasks[t.index])}}},[i("div",{staticClass:"lesson-title-r"},[i("div",{staticClass:"lesson-title-des"},[e.doubleLine(t.tasks[t.index])?e._e():i("div",{staticClass:"bl l22"},[i("span",{staticClass:"text-overflow ks",class:{lessonactive:e.currentTask==t.tasks[t.index].id}},[i("i",{staticClass:"iconfont",class:e.iconfont(t.tasks[t.index])}),e._v("\n              "+e._s(Number(t.tasks[t.index].isOptional)?"ÈÄâ‰øÆ ":"ËØæÊó∂")+e._s(Number(t.tasks[t.index].isOptional)?" ":t.tasks[t.index].number+":"+t.title)+"\n            ")])]),e.doubleLine(t.tasks[t.index])?i("div",{staticClass:"bl"},[i("div",{staticClass:"block-inline"},[i("span",{staticClass:"bl text-overflow ks",class:{lessonactive:e.currentTask==t.tasks[t.index].id}},[i("i",{staticClass:"iconfont",class:e.iconfont(t.tasks[t.index])}),e._v("\n                "+e._s(Number(t.tasks[t.index].isOptional)?"ÈÄâ‰øÆ ":"ËØæÊó∂")+e._s(Number(t.tasks[t.index].isOptional)?" ":t.tasks[t.index].number+":"+t.title)+"\n              ")]),i("span",{staticClass:"bl zbtime"},[i("span",{class:[e.liveClass(t.tasks[t.index])]},[e._v(e._s(e._f("filterTaskTime")(t.tasks[t.index])))])])])]):e._e()])]),i("div",{staticClass:"lesson-title-l"},["live"!=t.tasks[t.index].type?i("span",[e._v(e._s(e._f("filterTaskTime")(t.tasks[t.index])))]):e._e(),i("i",{staticClass:"iconfont",class:e.studyStatus(t.tasks[t.index])})])]),t.tasks.length>1?i("div",{staticClass:"lesson-items"},e._l(t.tasks,(function(t,s){return e.showTask(t,s)?i("div",{key:s,staticClass:"litem",attrs:{id:t.id},on:{click:function(i){return e.lessonCellClick(t)}}},[i("div",{staticClass:"litem-r text-overflow",class:{lessonactive:e.currentTask==Number(t.id)}},[i("i",{staticClass:"iconfont",class:e.iconfont(t)}),e._v("\n          "+e._s(Number(t.isOptional)?"ÈÄâ‰øÆ ":"ËØæÊó∂")+e._s(Number(t.isOptional)?" ":t.number+":"+t.title)+"\n        ")]),i("div",{staticClass:"litem-l clearfix"},[i("span",{class:[e.liveClass(t),"text-overflow"]},[e._v(e._s(e._f("filterTaskTime")(t)))]),i("i",{staticClass:"iconfont",class:e.studyStatus(t)})])]):e._e()})),0):e._e()]):e._e()})),e.isNoData?i("div",{staticClass:"noneItem"},[i("img",{staticClass:"notask",attrs:{src:"static/images/none.png"}}),i("p",[e._v("ÊöÇÊó∂ËøòÊ≤°ÊúâËØæÊó∂Âì¶...")])]):e._e()],2)}),[],!1,null,null,null).exports,S=i("3ce7"),T={name:"AfterjoinDirectory",components:{swiperDirectory:b,utilDirectory:_,lessonDirectory:C},data:function(){return{scroll:"",item:[],level:3,chapterNum:0,unitNum:0,lessonNum:0,currentChapter:0,currentUnit:0,currentLesson:0,slideIndex:0,taskId:null,nodata:!1}},computed:Object(n.a)({},Object(p.d)("course",{nextStudy:function(e){return e.nextStudy},selectedPlanId:function(e){return e.selectedPlanId},OptimizationCourseLessons:function(e){return e.OptimizationCourseLessons}}),{hasChapter:function(){return this.chapterNum>0}}),watch:{nextStudy:{handler:"getNextStudy",immediate:!0},selectedPlanId:{handler:"processItem",immediate:!0,deep:!0}},methods:{getNextStudy:function(){this.nextStudy.nextTask&&(this.taskId=Number(this.nextStudy.nextTask.id))},processItem:function(e){var t=this.OptimizationCourseLessons;this.resetData(),t.length?(this.nodata=!1,this.setItems(t),this.mapChild(this.item),this.startScroll()):this.nodata=!0},resetData:function(){this.chapterNum=0,this.unitNum=0,this.lessonNum=0},setItems:function(e){this.level=1===e.length&&0==e[0].isExist?2:3,1===e.length?this.item=2===this.level?e[0].children:e:e.length>1&&(this.item=e)},mapChild:function(e){var t=this;e.map((function(i,s){"chapter"===i.type?t.formatChapter(i,e,s):"unit"===i.type?t.formatUnit(i,e,s):"lesson"===i.type?t.formatLesson(i,e,s):t.formatTask(i,e,s)}))},startScroll:function(){var e=this;this.$nextTick((function(){if(e.taskId){var t=document.getElementById("progress-bar"),i=document.getElementById("swiper-directory"),s=document.getElementById(e.taskId),n=t?t.offsetHeight:0,r=i?i.offsetHeight:0,a=(s?s.offsetTop:0)-n-44-r;a<document.documentElement.clientWidth||window.scrollTo({top:a})}}))},formatChapter:function(e,t,i){this.currentChapter=i,e.chapterNum=0,e.unitNum=0,e.lessonNum=0,e.tasksNum=0,e.isExist&&(this.chapterNum+=1,this.computedNum(1,"chapterNum")),Array.isArray(e.children)&&e.children.length>0&&this.mapChild(e.children)},formatUnit:function(e,t,i){this.currentUnit=i,e.unitNum=0,e.lessonNum=0,e.tasksNum=0,e.isExist&&(this.unitNum+=1,this.computedNum(1,"unitNum")),Array.isArray(e.children)&&e.children.length>0&&(this.computedNum(e.children.length,"lessonNum"),this.mapChild(e.children))},formatLesson:function(e,t,i){this.currentLesson=i,e.isExist&&(this.lessonNum+=1),e.tasks&&(this.computedNum(e.tasks.length-1,"tasksNum"),this.mapChild(e.tasks))},formatTask:function(e,t,i){Number(e.id)===this.taskId&&(this.slideIndex=3==this.level?this.currentChapter:this.currentUnit),this.getLessonIndex(e,i),e.chapterIndex=this.currentChapter,e.unitIndex=this.currentUnit},getLessonIndex:function(e,t){e.mode?"lesson"===e.mode&&this.getMainTask(e,t):this.getMainTask(e,0)},getMainTask:function(e,t){3===this.level?this.$set(this.item[this.currentChapter].children[this.currentUnit].children[this.currentLesson],"index",t):this.$set(this.item[this.currentUnit].children[this.currentLesson],"index",t)},computedNum:function(e,t){var i=3===this.level?this.currentChapter:this.currentUnit,s=this.item[i][t]+e;this.$set(this.item[i],t,s)},changeChapter:function(e){this.slideIndex=e}}},O=Object(f.a)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"afterjoin-directory"},[e.lessonNum>0?i("div",[e.chapterNum>0||e.unitNum>0?i("swiper-directory",{attrs:{id:"swiper-directory",item:e.item,"slide-index":e.slideIndex,"has-chapter":e.hasChapter},on:{changeChapter:e.changeChapter}}):e._e(),e.item.length>0?i("div",{attrs:{id:"lesson-directory"}},[e.chapterNum>0?e._l(e.item[e.slideIndex].children,(function(t,s){return i("div",{key:s,staticClass:"pd-bo"},[i("util-directory",{attrs:{util:t}}),i("lesson-directory",e._g(e._b({attrs:{lesson:t.children,"task-id":e.taskId,"task-number":e.item[e.slideIndex].lessonNum,"unit-num":e.item[e.slideIndex].unitNum}},"lesson-directory",e.$attrs,!1),e.$listeners))],1)})):i("div",{staticClass:"pd-bo"},[i("lesson-directory",e._g(e._b({attrs:{lesson:e.item[e.slideIndex].children,"task-id":e.taskId,"task-number":e.item[e.slideIndex].lessonNum,"unit-num":e.item[e.slideIndex].unitNum}},"lesson-directory",e.$attrs,!1),e.$listeners))],1)],2):e._e()],1):e._e(),e.nodata&&0==e.lessonNum?i("div",{staticClass:"noneItem"},[i("img",{staticClass:"nodata",attrs:{src:"static/images/none.png"}}),i("p",[e._v("ÊöÇÊó∂ËøòÊ≤°ÊúâËØæÁ®ãÂì¶...")])]):e._e()])}),[],!1,null,null,null).exports,j={inheritAttrs:!0,props:{details:{type:Object,value:function(){}}},data:function(){return{headBottom:0,active:1,scrollFlag:!1,tabs:["ËØæÁ®ã‰ªãÁªç","ËØæÁ®ãÁõÆÂΩï","Â≠¶ÂëòËØÑ‰ª∑"],tabFixed:!1,errorMsg:"",offsetTop:"",offsetHeight:"",isFixed:!1}},computed:Object(n.a)({},Object(p.d)("course",{selectedPlanId:function(e){return e.selectedPlanId}}),{},Object(p.d)(["user"]),{progress:function(){return Number(this.details.publishedTaskNum)?parseInt(this.details.progress.percent)+"%":"0%"},summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)}}),watch:{selectedPlanId:function(e,t){this.active=1}},mounted:function(){window.addEventListener("scroll",this.handleScroll),this.$nextTick((function(){var e=document.getElementById("course-detail__head").offsetHeight;this.offsetTop=e+46,this.offsetHeight=44}))},created:function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.showDialog();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),components:{Directory:c.a,DetailHead:u.a,DetailPlan:m,Teacher:y,reviewList:o.a,afterjoinDirectory:O},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:{showDialog:function(){var e=this;if(this.details.member){var t="";if(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t){this.errorMsg=this.getErrorMsg(t);var i="",n=function(){};if("course.expired"===t||"member.expired"===t&&!this.isClassCourse){i="ËØæÁ®ãÂ∑≤Âà∞ÊúüÔºåÊó†Ê≥ïÁªßÁª≠Â≠¶‰π†ÔºåÊòØÂê¶ÈÄÄÂá∫";var r={id:this.details.id};n=function(){S.a.deleteCourse({query:r}).then((function(e){e.success?window.location.reload():s.a.fail("ÈÄÄÂá∫ËØæÁ®ãÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï")}))},this.callConfirm(i,n)}else"vip.member_expired"===t?(i="‰ºöÂëòÂ∑≤Âà∞ÊúüÔºåËØ∑ÂèäÊó∂Áª≠Ë¥π‰ºöÂëò",n=function(){e.$router.push({path:"/vip"})},this.callConfirm(i,n)):s.a.fail(this.errorMsg)}}},getErrorMsg:function(e){switch(e){case"course.not_found":return"ÂΩìÂâçËØæÁ®ã‰∏çÂ≠òÂú®";case"course.unpublished":return"ÂΩìÂâçËØæÁ®ãÊú™ÂèëÂ∏É";case"course.expired":return"ÂΩìÂâçËØæÁ®ãÂ∑≤ËøáÊúü";case"course.not_arrive":return"ÂΩìÂâçËØæÁ®ãËøò‰∏çËÉΩÂ≠¶‰π†";case"user.not_login":return"Áî®Êà∑Êú™ÁôªÂΩï";case"user.locked":return"Áî®Êà∑Ë¢´ÈîÅÂÆö";case"member.not_found":return"Áî®Êà∑Êú™Âä†ÂÖ•ËØæÁ®ã";case"member.expired":return"ËØæÁ®ãÂ∑≤ËøáÊúü";case"vip.vip_closed":return"ÁΩëÊ†°Â∑≤ÂÖ≥Èó≠‰ºöÂëòÂäüËÉΩ";case"vip.not_login":return"Áî®Êà∑Êú™ÁôªÂΩï";case"vip.not_member":return"ÂΩìÂâçÁî®Êà∑Âπ∂‰∏çÊòØvip";case"vip.member_expired":return"Áî®Êà∑‰ºöÂëòÊúçÂä°Â∑≤ËøáÊúü";case"vip.level_not_exist":return"Áî®Êà∑‰ºöÂëòÁ≠âÁ∫ßÊàñËØæÁ®ã‰ºöÂëò‰∏çÂ≠òÂú®";case"vip.level_low":return"Áî®Êà∑‰ºöÂëòÁ≠âÁ∫ßËøá‰Ωé";default:return"ÂºÇÂ∏∏ÈîôËØØ"}},callConfirm:function(e,t){r.a.confirm({message:e,title:""}).then((function(){t()})).catch((function(){}))},handleScroll:function(){var e=document.getElementById("swiper-directory"),t=document.documentElement.scrollHeight,i=document.documentElement.clientHeight;(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)>this.offsetTop&&t-this.offsetTop>i?(this.tabFixed=!0,e&&e.classList.add("swiper-directory-fix")):(this.tabFixed=!1,e&&e.classList.remove("swiper-directory-fix"))}}},D=Object(f.a)(j,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"join-after"},[i("detail-head",{attrs:{"course-set":e.details.courseSet}}),i("van-tabs",{ref:"tabs",class:e.tabFixed?"isFixed":"",attrs:{id:"tabs"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return i("van-tab",{key:e,attrs:{title:e}})})),1),i("div",{staticClass:"join-after__content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:1==e.active,expression:"active == 1"}]},[i("div",{class:["progress-bar",e.tabFixed?"progress-bar-fix":""],attrs:{id:"progress-bar"}},[i("div",{staticClass:"progress-bar__content"},[i("div",{staticClass:"progress-bar__rate",style:{width:e.progress}})]),i("div",{staticClass:"progress-bar__text"},[e._v(e._s(e.progress))])]),i("afterjoin-directory",{attrs:{"error-msg":e.errorMsg},on:{showDialog:e.showDialog}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:0==e.active,expression:"active == 0"}]},[i("detail-plan",{on:{switchPlan:e.showDialog}}),i("div",{staticClass:"segmentation"}),i("e-panel",{attrs:{title:"ËØæÁ®ã‰ªãÁªç"}},[i("div",{domProps:{innerHTML:e._s(e.summary)}})]),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:2==e.active,expression:"active == 2"}]},[i("review-list",{ref:"review",attrs:{"target-id":e.details.courseSet.id,reviews:e.details.reviews,title:"Â≠¶ÂëòËØÑ‰ª∑","defaul-value":"ÊöÇÊó†ËØÑ‰ª∑",type:"course"}})],1)])],1)}),[],!1,null,null,null).exports,I=(i("ac6a"),i("456d"),i("86ee")),E=i("49a2"),N=i("8b9d"),P=i("a262"),A=i("0d25"),L={name:"JoinBefore",components:{Teacher:y,Directory:c.a,DetailHead:u.a,DetailPlan:m,moreMask:I.a,reviewList:o.a,onsale:E.a},mixins:[k.a,N.a,P.a],data:function(){return{tabs:["ËØæÁ®ã‰ªãÁªç","ËØæÁ®ãÁõÆÂΩï","Â≠¶ÂëòËØÑ‰ª∑"],loadMoreAbout:!1,active:0,tabsClass:"",learnExpiry:"Ê∞∏‰πÖÊúâÊïà",startDateStr:"",endDateStr:"",tops:{aboutTop:0,courseTop:0,reviewTop:0},isEmpty:!0,unreceivedCoupons:[],miniCoupons:[],marketingActivities:{seckill:{}}}},computed:Object(n.a)({},Object(p.d)(["couponSwitch","user"]),{},Object(p.d)("course",{details:function(e){return e.details}}),{summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)},accessToJoin:function(){return"success"===this.details.access.code||"user.not_login"===this.details.access.code},vipAccessToJoin:function(){var e=!1;return!(!this.details.vipLevel||!this.user.vip)&&(this.details.vipLevel.seq<=this.user.vip.seq&&(e=!(new Date(this.user.vip.deadline).getTime()<(new Date).getTime())),e)},showOnsale:function(){return!this.isClassCourse&&0!==Number(this.details.price)&&!!(this.unreceivedCoupons.length||Object.keys(this.marketingActivities).length&&!this.onlySeckill)},onlySeckill:function(){return 1===Object.keys(this.marketingActivities).length&&this.marketingActivities.seckill},seckillStatus:function(){var e=this.marketingActivities.seckill;return Object(A.dateTimeDown)(new Date(e.endTime).getTime())},showSeckill:function(){var e=this.marketingActivities.seckill;return!this.isClassCourse&&0!==Number(this.details.price)&&e&&"ongoing"==e.status&&!this.isEmpty}}),mounted:function(){var e=this;!this.isClassCourse&&this.couponSwitch&&(S.a.searchCoupon({params:{targetId:this.details.courseSet.id,targetType:"course"}}).then((function(t){e.unreceivedCoupons=t.data,e.miniCoupons=e.unreceivedCoupons.length>3?e.unreceivedCoupons.slice(0,4):e.unreceivedCoupons})).catch((function(e){})),S.a.coursesActivities({query:{id:this.details.id}}).then((function(t){e.marketingActivities=t,e.isEmpty=!t.seckill||!+t.seckill.productRemaind})).catch((function(e){}))),window.addEventListener("touchmove",this.handleScroll),window.addEventListener("scroll",this.handleScroll),setTimeout((function(){window.scrollTo(0,0)}),100)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll),window.removeEventListener("scroll",this.handleScroll)},methods:Object(n.a)({},Object(p.b)("course",["joinCourse","getAfterCourse"]),{onTabClick:function(e,t){var i=this.$refs[this.transIndex2Tab(e)];window.scrollTo(0,i.$el.offsetTop-44)},transIndex2Tab:function(e){return["about","directory","review"][e]},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs,i=["about","directory","review"].reverse();setTimeout((function(){Object.keys(t).forEach((function(i){t[i]&&(e.tops["".concat(i,"Top")]=t[i].$el.getBoundingClientRect().top)})),e.scrollFlag=!1,e.tabsClass=e.tops.aboutTop-44<=0?"van-tabs--fixed":"";for(var s=0;s<i.length;s++)if(e.tops["".concat(i[s],"Top")]-44<=0)return void(e.active=i.length-s-1)}),400)}},activeCurrentTab:function(e){var t=this.tops;return(e+=44)<t.teacherTop?0:e>=t.directoryTop?2:1},handleJoin:function(){var e=this,t=this.vipAccessToJoin;if(this.accessToJoin||t)if(this.$store.state.token){var i=this.details.learningExpiryDate.expiryEndDate,s=new Date(i).getTime(),n=(new Date).getTime(),r=n<s;r=0==i||n<s,(Number(this.details.buyable)&&r||t)&&(+this.details.price&&!t?this.getOrder():this.joinCourse({id:this.details.id}).then((function(t){0!==Object.keys(t).length||e.getOrder()})).catch((function(e){})))}else this.$router.push({name:"login",query:{redirect:this.redirect}})},getAfCourse:function(e){this.getAfterCourse({courseId:e}).then((function(){})).catch((function(e){Toast.fail(e.message)}))},getLearnExpiry:function(e){this.learnExpiry=e.val,this.startDateStr=e.startDateStr,this.endDateStr=e.endDateStr},switchPlan:function(){var e=this;this.marketingActivities={},S.a.coursesActivities({query:{id:this.details.id}}).then((function(t){e.marketingActivities=t})).catch((function(e){}))},getOrder:function(){var e=this.details.learningExpiryDate.expiryMode,t="".concat(this.startDateStr," Ëá≥ ").concat(this.endDateStr),i="date"===e?t:this.learnExpiry;this.$router.push({name:"order",params:{id:this.details.id},query:{expiryScope:i,targetType:"course"}})},sellOut:function(){this.isEmpty=!0}})},$=Object(f.a)(L,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.isClassCourse?"":"join-before"},[i("detail-head",{attrs:{price:e.details.price,"course-set":e.details.courseSet,"seckill-activities":e.marketingActivities.seckill},on:{goodsEmpty:e.sellOut}}),i("detail-plan",{on:{getLearnExpiry:e.getLearnExpiry,switchPlan:e.switchPlan}}),i("div",{staticClass:"segmentation"}),e.showOnsale?[i("onsale",{attrs:{"unreceived-coupons":e.unreceivedCoupons,"mini-coupons":e.miniCoupons,activities:e.marketingActivities}}),i("div",{staticClass:"segmentation"})]:e._e(),i("van-tabs",{class:e.tabsClass,on:{click:e.onTabClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return i("van-tab",{key:e,attrs:{title:e}})})),1),i("e-panel",{ref:"about",staticClass:"about",attrs:{title:"ËØæÁ®ã‰ªãÁªç"}},[i("more-mask",{attrs:{disabled:e.loadMoreAbout},on:{maskLoadMore:function(t){e.loadMoreAbout=!0}}},[i("div",{domProps:{innerHTML:e._s(e.summary)}})])],1),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers,title:"ÊïôÂ∏à‰ªãÁªç"}}),i("div",{staticClass:"segmentation"}),i("directory",{ref:"directory"}),i("div",{staticClass:"segmentation"}),i("review-list",{ref:"review",attrs:{"target-id":e.details.courseSet.id,reviews:e.details.reviews,title:"Â≠¶ÂëòËØÑ‰ª∑",type:"course","defaul-value":"ÊöÇÊó†ËØÑ‰ª∑"}}),e.isClassCourse||e.marketingActivities.seckill&&(!e.marketingActivities.seckill||!e.isEmpty&&"Â∑≤Âà∞Êúü"!==e.seckillStatus)&&0!=e.details.price?e._e():i("e-footer",{attrs:{disabled:!e.accessToJoin},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v("\n    "+e._s(e._f("filterJoinStatus")(e.details.access.code,"course",e.vipAccessToJoin)))]),e.showSeckill&&"Â∑≤Âà∞Êúü"!==e.seckillStatus?i("div",[i("e-footer",{attrs:{disabled:!e.accessToJoin,half:"true"},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v(e._s(e._f("filterJoinStatus")(e.details.access.code,"course",e.vipAccessToJoin)))]),i("e-footer",{attrs:{half:"true"},nativeOn:{click:function(t){return e.activityHandle(e.marketingActivities.seckill.id)}}},[e._v("ÂéªÁßíÊùÄ")])],1):e._e()],2)}),[],!1,null,null,null).exports,M=(i("3022"),{components:{},data:function(){return{currentComp:""}},computed:Object(n.a)({},Object(p.d)("course",{selectedPlanIndex:function(e){return e.selectedPlanIndex},joinStatus:function(e){return e.joinStatus},details:function(e){return e.details},selectedPlanId:function(e){return e.selectedPlanId}}),{},Object(p.d)({isLoading:function(e){return e.isLoading}})),watch:{joinStatus:{handler:"joinStatusChange"},$route:function(e,t){this.getData()}},created:function(){this.getData()},methods:Object(n.a)({},Object(p.b)("course",["getCourseLessons"]),{},Object(p.c)("course",{setSourceType:l.p}),{getData:function(){var e=this;this.getCourseLessons({courseId:this.$route.params.id}).then((function(t){e.joinStatusChange(t.member)}))},joinStatusChange:function(e){this.currentComp="",this.currentComp=e?D:$},getJoinAfter:function(){this.getJoinAfterDetail({courseId:this.$route.params.id}).then((function(e){})).catch((function(e){s.a.fail(e.message)}))}}),beforeRouteLeave:function(e,t,i){this.setSourceType({sourceType:"img",taskId:0}),i()}}),z=Object(f.a)(M,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail"},[this.isLoading?t("e-loading"):this._e(),t(this.currentComp,{tag:"component",attrs:{details:this.details}})],1)}),[],!1,null,null,null);t.default=z.exports}}]);