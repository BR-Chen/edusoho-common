(window.webpackJsonp=window.webpackJsonp||[]).push([["coupon_receive"],{1527:function(e,t,n){"use strict";n("e7e5");var i=n("d399"),o=n("7185");t.a={data:function(){return{count:{showCount:!1,num:60,codeBtnDisable:!1}}},methods:{validateMobileOrPsw:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mobile",t=this.userinfo[e],n=o.a[e];0===t.length&&(this.errorMessage[e]=""),this.errorMessage[e]=n.validator(t)?"":n.message},validatedChecker:function(){this.userinfo.mobile.length>11&&(this.userinfo.mobile=this.userinfo.mobile.substring(0,11));var e=this.userinfo.mobile,t=o.a.mobile;this.validated.mobile=t.validator(e)},countDown:function(){var e=this;this.$nextTick((function(){e.$refs.smsCode.$refs.input.focus()})),this.count.showCount=!0,this.count.codeBtnDisable=!0,this.count.num=60;var t=setInterval((function(){if(e.count.num<=0)return e.count.codeBtnDisable=!1,e.count.showCount=!1,void clearInterval(t);e.count.num-=1}),1e3)},handleSubmit:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.btnDisable||this.fastLogin({mobile:this.userinfo.mobile,smsToken:this.userinfo.smsToken,smsCode:this.userinfo.smsCode,loginType:"sms",client:"h5"}).then((function(t){return e(t)})).catch((function(e){t&&t(e.message),i.a.fail(e.message)}))},handleSendSms:function(){var e=this;this.sendSmsSend(this.userinfo).then((function(t){e.userinfo.smsToken=t.smsToken,e.countDown(),e.dragEnable=!1,e.userinfo.dragCaptchaToken=""})).catch((function(t){switch(t.code){case 4030301:case 4030302:e.dragKey+=1,e.userinfo.dragCaptchaToken="",e.userinfo.smsToken="",i.a.fail(t.message);break;case 4030303:e.dragEnable?i.a.fail(t.message):e.dragEnable=!0;break;default:i.a.fail(t.message)}}))},clickSmsBtn:function(){!this.count.codeBtnDisable&&this.validated.mobile&&(this.dragEnable?this.$refs.dragComponent.dragToEnd?this.$refs.dragComponent.initDragCaptcha():Object(i.a)("请先完成拼图验证"):this.handleSendSms())}}}},"4eb5":function(e,t,n){var i=n("6981"),o={autoSetContainer:!1,appendToBody:!0},r={install:function(e){e.prototype.$clipboardConfig=o,e.prototype.$copyText=function(e,t){return new Promise((function(n,r){var a=document.createElement("button"),s=new i(a,{text:function(){return e},action:function(){return"copy"},container:"object"==typeof t?t:document.body});s.on("success",(function(e){s.destroy(),n(e)})),s.on("error",(function(e){s.destroy(),r(e)})),o.appendToBody&&document.body.appendChild(a),a.click(),o.appendToBody&&document.body.removeChild(a)}))},e.directive("clipboard",{bind:function(e,t,n){if("success"===t.arg)e._vClipboard_success=t.value;else if("error"===t.arg)e._vClipboard_error=t.value;else{var r=new i(e,{text:function(){return t.value},action:function(){return"cut"===t.arg?"cut":"copy"},container:o.autoSetContainer?e:void 0});r.on("success",(function(t){var n=e._vClipboard_success;n&&n(t)})),r.on("error",(function(t){var n=e._vClipboard_error;n&&n(t)})),e._vClipboard=r}},update:function(e,t){"success"===t.arg?e._vClipboard_success=t.value:"error"===t.arg?e._vClipboard_error=t.value:(e._vClipboard.text=function(){return t.value},e._vClipboard.action=function(){return"cut"===t.arg?"cut":"copy"})},unbind:function(e,t){"success"===t.arg?delete e._vClipboard_success:"error"===t.arg?delete e._vClipboard_error:(e._vClipboard.destroy(),delete e._vClipboard)}})},config:o};e.exports=r},"504c":function(e,t,n){var i=n("9e1e"),o=n("0d58"),r=n("6821"),a=n("52a7").f;e.exports=function(e){return function(t){for(var n,s=r(t),c=o(s),u=c.length,l=0,d=[];u>l;)n=c[l++],i&&!a.call(s,n)||d.push(e?[n,s[n]]:s[n]);return d}}},5118:function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("6017"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("c8ba"))},6017:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,o,r,a,s,c=1,u={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):i=function(e){setTimeout(p,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return u[c]=o,i(c),c++},f.clearImmediate=h}function h(e){delete u[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{h(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("c8ba"),n("f28c"))},6981:function(e,t,n){
/*!
 * clipboard.js v2.0.4
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT © Zeno Rocha
 */
e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=c(n(1)),a=c(n(3)),s=c(n(4));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===i(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,s.default)(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return l("action",e)}},{key:"defaultTarget",value:function(e){var t=l("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return l("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach((function(e){n=n&&!!document.queryCommandSupported(e)})),n}}]),t}();function l(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=u},function(e,t,n){"use strict";var i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),s=(i=a)&&i.__esModule?i:{default:i},c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return r(e,[{key:"resolveOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,s.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,s.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":o(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=c},function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),o=document.createRange();o.selectNodeContents(e),i.removeAllRanges(),i.addRange(o),t=i.toString()}return t}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function o(){i.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,o=n.length;i<o;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],o=[];if(i&&t)for(var r=0,a=i.length;r<a;r++)i[r].fn!==t&&i[r].fn._!==t&&o.push(i[r]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){var i=n(5),o=n(6);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return f=t,h=n,(d=e).addEventListener(f,h),{destroy:function(){d.removeEventListener(f,h)}};if(i.nodeList(e))return c=e,u=t,l=n,Array.prototype.forEach.call(c,(function(e){e.addEventListener(u,l)})),{destroy:function(){Array.prototype.forEach.call(c,(function(e){e.removeEventListener(u,l)}))}};if(i.string(e))return r=e,a=t,s=n,o(document.body,r,a,s);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var r,a,s,c,u,l,d,f,h}},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,n){var i=n(7);function o(e,t,n,o,r){var a=function(e,t,n,o){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&o.call(e,n)}}.apply(this,arguments);return e.addEventListener(n,a,r),{destroy:function(){e.removeEventListener(n,a,r)}}}e.exports=function(e,t,n,i,r){return"function"==typeof e.addEventListener?o.apply(null,arguments):"function"==typeof n?o.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return o(e,t,n,i,r)})))}},function(e,t){if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}}])},7067:function(e,t,n){"use strict";n("e17f");var i=n("2241"),o=(n("e7e5"),n("d399")),r=n("a026"),a=n("3ce7"),s=n("4eb5"),c=n.n(s);r.a.use(c.a);var u=/micromessenger/.test(navigator.userAgent.toLowerCase());t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||n&&!t)o.a.fail("缺少分享参数");else{var s={domainUri:location.origin,itemUri:"",source:"h5"};a.a.marketingActivities({query:{activityId:e},data:s}).then((function(e){var a=-1!==e.url.indexOf("?")?"&":"?",s=n?"".concat(t).concat(a,"ticket=").concat(e.ticket):e.url;u?window.location.href=s:i.a.confirm({message:"去微信完成活动",confirmButtonText:"复制链接",title:""}).then((function(){try{r.a.prototype.$copyText(s).then((function(){o.a.success("复制成功")}),(function(){o.a.fail("请更换浏览器复制")}))}catch(e){o.a.fail("请更换浏览器复制")}})).catch((function(){}))})).catch((function(e){o.a.fail(e.message)}))}}},8615:function(e,t,n){var i=n("5ca1"),o=n("504c")(!1);i(i.S,"Object",{values:function(e){return o(e)}})},8813:function(e,t,n){"use strict";n("28a5"),n("6b54"),n("c5f6");var i=n("0d25");t.a={methods:{timeExpire:function(e,t){return e?(e=Object(i.formatFullTime)(new Date(e)),t=Object(i.formatFullTime)(new Date(t)),"".concat(e," 至 ").concat(t)):(t=Object(i.formatFullTime)(new Date(t)),"有效期截止：".concat(t))},timeCalculation:function(e){var t=(new Date).setDate((new Date).getDate()+Number(e));return t=Object(i.formatFullTime)(new Date(t)),"有效期至：".concat(t)},priceHtml:function(e){var t=e.rate,n=e.type,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=parseInt(t,10),r=o.toString().length>3?"text-16 ml-5":"",a=Number(t).toFixed(2).split(".")[1];a=0===Number(a)?"":".".concat(a);var s="discount"===n?"折":"元";return i?'<span class="'.concat(r,'">').concat(o,'</span><span class="text-14">').concat(a+s,"</span>"):o+a+s},scopeFilter:function(e){var t=e.targetDetail,n=t.numType,i=t.product,o="";if("single"===n)switch(i){case"course":case"classroom":o="指定商品";break;case"vip":o="指定会员";break;default:o=""}else if("all"===n)switch(i){case"course":o="全部课程";break;case"classroom":o="全部班级";break;case"all":o="全部商品";break;case"vip":o="全部会员";break;default:o=""}else switch(i){case"course":case"classroom":o="部分商品";break;default:o=""}return o},handleClick:function(e){this.$emit("buttonClick",e)},receiveTimeExpire:function(e){return Object(i.formatchinaTime)(new Date(e))}}}},"8b9d":function(e,t,n){"use strict";n("6762"),n("2fdb"),n("ac6a"),n("8615"),n("e7e5");var i=n("d399"),o=n("3ce7"),r={classroom:"classroom",course:"course",vip:"vip",all:"all"};t.a={methods:{couponHandle:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.$store.state.token)if(e.currentUserCoupon||t)this.hasreceiveCoupon(e);else{var n=e.token;o.a.receiveCoupon({data:{token:n}}).then((function(t){e.currentUserCoupon=t,i.a.success({message:"领取成功",duration:2e3})})).catch((function(t){i.a.fail(t.message),e.unreceivedNum="0"}))}else this.$router.push({name:"login",query:{redirect:this.$route.fullPath}})},hasreceiveCoupon:function(e){var t=this,n=e.targetDetail.product,o=e.targetDetail.numType;if(Object.values(r).includes(n))if("single"===o){var a=e.target.id;if(n===r.vip)return void this.$router.push({path:"/vip",query:{id:a}});this.getPathParams(n,a).then((function(e){var i=e.id;i&&t.$router.push({path:"/".concat(n,"/").concat(i)})}))}else"multi"===o?this.$router.push({path:"/".concat(e.targetDetail.product,"/explore")}):this.$router.push({path:"/"});else i.a.fail("暂不支持查看：".concat(n,"类型商品"))},getPathParams:function(e,t){return e!==r.course?Promise.resolve({id:t}):o.a.getCourseByCourseSet({query:{id:t}}).then((function(e){return e.length&&e[0]?{id:e[0].id}:Promise.reject({message:"当前课程不存在了"})})).catch((function(e){i.a.fail(e.message)}))}}}},"8e6c":function(e,t,n){"use strict";n("6b54"),n("28a5"),function(e){var t,n;void 0===e.btoa&&(e.btoa=(t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),function(e){var n,i,o,r,a,s,c;for(i=o=0,r=e.length,s=(r-=a=r%3)/3<<2,a>0&&(s+=4),n=new Array(s);i<r;)c=e.charCodeAt(i++)<<16|e.charCodeAt(i++)<<8|e.charCodeAt(i++),n[o++]=t[c>>18]+t[c>>12&63]+t[c>>6&63]+t[63&c];return 1==a?(c=e.charCodeAt(i++),n[o++]="".concat(t[c>>2]+t[(3&c)<<4],"==")):2==a&&(c=e.charCodeAt(i++)<<8|e.charCodeAt(i++),n[o++]="".concat(t[c>>10]+t[c>>4&63]+t[(15&c)<<2],"=")),n.join("")})),void 0===e.atob&&(e.atob=(n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],function(e){var t,i,o,r,a,s,c,u,l,d;if((c=e.length)%4!=0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(e))return"";for(l=c,(u="="==e.charAt(c-2)?1:"="==e.charAt(c-1)?2:0)>0&&(l-=4),l=3*(l>>2)+u,d=new Array(l),a=s=0;a<c&&-1!=(t=n[e.charCodeAt(a++)])&&-1!=(i=n[e.charCodeAt(a++)])&&(d[s++]=String.fromCharCode(t<<2|(48&i)>>4),-1!=(o=n[e.charCodeAt(a++)]))&&(d[s++]=String.fromCharCode((15&i)<<4|(60&o)>>2),-1!=(r=n[e.charCodeAt(a++)]));)d[s++]=String.fromCharCode((3&o)<<6|r);return d.join("")}));var i=2654435769;function o(e,t){var n=e.length,i=n<<2;if(t){var o=e[n-1];if(o<(i-=4)-3||o>i)return null;i=o}for(var r=0;r<n;r++)e[r]=String.fromCharCode(255&e[r],e[r]>>>8&255,e[r]>>>16&255,e[r]>>>24&255);var a=e.join("");return t?a.substring(0,i):a}function r(e,t){var n,i=e.length,o=i>>2;0!=(3&i)&&++o,t?(n=new Array(o+1))[o]=i:n=new Array(o);for(var r=0;r<i;++r)n[r>>2]|=e.charCodeAt(r)<<((3&r)<<3);return n}function a(e){return 4294967295&e}function s(e,t,n,i,o,r){return(n>>>5^t<<2)+(t>>>3^n<<4)^(e^t)+(r[3&i^o]^n)}function c(e){return e.length<4&&(e.length=4),e}function u(e){if(/^[\x00-\x7f]*$/.test(e))return e;for(var t=[],n=e.length,i=0,o=0;i<n;++i,++o){var r=e.charCodeAt(i);if(r<128)t[o]=e.charAt(i);else if(r<2048)t[o]=String.fromCharCode(192|r>>6,128|63&r);else{if(!(r<55296||r>57343)){if(i+1<n){var a=e.charCodeAt(i+1);if(r<56320&&a>=56320&&a<=57343){var s=65536+((1023&r)<<10|1023&a);t[o]=String.fromCharCode(240|s>>18&63,128|s>>12&63,128|s>>6&63,128|63&s),++i;continue}}throw new Error("Malformed string")}t[o]=String.fromCharCode(224|r>>12,128|r>>6&63,128|63&r)}}return t.join("")}function l(e,t){return(null==t||t<0)&&(t=e.length),0===t?"":/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?t===e.length?e:e.substr(0,t):t<65535?function(e,t){for(var n=new Array(t),i=0,o=0,r=e.length;i<t&&o<r;i++){var a=e.charCodeAt(o++);switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n[i]=a;break;case 12:case 13:if(!(o<r))throw new Error("Unfinished UTF-8 octet sequence");n[i]=(31&a)<<6|63&e.charCodeAt(o++);break;case 14:if(!(o+1<r))throw new Error("Unfinished UTF-8 octet sequence");n[i]=(15&a)<<12|(63&e.charCodeAt(o++))<<6|63&e.charCodeAt(o++);break;case 15:if(!(o+2<r))throw new Error("Unfinished UTF-8 octet sequence");var s=((7&a)<<18|(63&e.charCodeAt(o++))<<12|(63&e.charCodeAt(o++))<<6|63&e.charCodeAt(o++))-65536;if(!(s>=0&&s<=1048575))throw new Error("Character outside valid Unicode range: 0x".concat(s.toString(16)));n[i++]=s>>10&1023|55296,n[i]=1023&s|56320;break;default:throw new Error("Bad UTF-8 encoding 0x".concat(a.toString(16)))}}return i<t&&(n.length=i),String.fromCharCode.apply(String,n)}(e,t):function(e,t){for(var n=[],i=new Array(32768),o=0,r=0,a=e.length;o<t&&r<a;o++){var s=e.charCodeAt(r++);switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i[o]=s;break;case 12:case 13:if(!(r<a))throw new Error("Unfinished UTF-8 octet sequence");i[o]=(31&s)<<6|63&e.charCodeAt(r++);break;case 14:if(!(r+1<a))throw new Error("Unfinished UTF-8 octet sequence");i[o]=(15&s)<<12|(63&e.charCodeAt(r++))<<6|63&e.charCodeAt(r++);break;case 15:if(!(r+2<a))throw new Error("Unfinished UTF-8 octet sequence");var c=((7&s)<<18|(63&e.charCodeAt(r++))<<12|(63&e.charCodeAt(r++))<<6|63&e.charCodeAt(r++))-65536;if(!(c>=0&&c<=1048575))throw new Error("Character outside valid Unicode range: 0x".concat(c.toString(16)));i[o++]=c>>10&1023|55296,i[o]=1023&c|56320;break;default:throw new Error("Bad UTF-8 encoding 0x".concat(s.toString(16)))}if(o>=32766){var u=o+1;i.length=u,n[n.length]=String.fromCharCode.apply(String,i),t-=u,o=-1}}return o>0&&(i.length=o,n[n.length]=String.fromCharCode.apply(String,i)),n.join("")}(e,t)}function d(e,t){return null==e||0===e.length?e:(e=u(e),t=u(t),o(function(e,t){var n,o,r,c,u,l,d=e.length,f=d-1;for(o=e[f],r=0,l=0|Math.floor(6+52/d);l>0;--l){for(c=(r=a(r+i))>>>2&3,u=0;u<f;++u)n=e[u+1],o=e[u]=a(e[u]+s(r,n,o,u,c,t));n=e[0],o=e[f]=a(e[f]+s(r,n,o,f,c,t))}return e}(r(e,!0),c(r(t,!1))),!1))}function f(e,t){return null==e||0===e.length?e:(t=u(t),l(o(function(e,t){var n,o,r,c,u,l=e.length,d=l-1;for(n=e[0],r=a(Math.floor(6+52/l)*i);0!==r;r=a(r-i)){for(c=r>>>2&3,u=d;u>0;--u)o=e[u-1],n=e[u]=a(e[u]-s(r,n,o,u,c,t));o=e[d],n=e[0]=a(e[0]-s(r,n,o,0,c,t))}return e}(r(e,!1),c(r(t,!1))),!0)))}e.XXTEA={utf8Encode:u,utf8Decode:l,encrypt:d,encryptToBase64:function(t,n){return e.btoa(d(t,n))},decrypt:f,decryptFromBase64:function(t,n){return null==t||0===t.length?t:f(e.atob(t),n)}}}(window)},a262:function(e,t,n){"use strict";var i=n("7067");t.a={methods:{activityHandle:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i.a)(e,t,n)}}}},cda6:function(e,t,n){"use strict";n.r(t),n("e7e5");var i=n("d399"),o=(n("ac6a"),n("456d"),n("db72")),r=n("2f62"),a=n("3ce7");function s(e){for(var t=e.toString().split("."),n=["","0","00","000","0000"].reverse(),i=0;i<t.length;i+=1){var o=t[i].length;t[i]=n[o]+t[i]}return t.join("")}n("c5f6"),n("6b54"),n("28a5");var c=function(e,t){var n=s(e),i=s(t);return Number(n)<=Number(i)},u=(n("96cf"),n("3b8d")),l=n("f13d"),d=(n("7185"),n("8e6c"),n("a262")),f=n("d863"),h=n("1527"),p={name:"CouponFast",components:{EDrag:l.a},mixins:[d.a,f.a,h.a],data:function(){return{isShow:!1,userinfo:{mobile:"",dragCaptchaToken:void 0,smsCode:"",smsToken:"",type:"sms_login"},dragEnable:!1,dragKey:0,errorMessage:{mobile:""},validated:{mobile:!1},count:{showCount:!1,num:60,codeBtnDisable:!1}}},computed:{btnDisable:function(){return!(this.userinfo.mobile&&this.userinfo.smsCode)},cansentCode:function(){return!(this.count.codeBtnDisable||!this.validated.mobile)}},methods:Object(o.a)({},Object(r.b)(["addUser","setMobile","sendSmsSend","fastLogin"]),{handleSubmitSuccess:function(){var e={mobile:this.userinfo.mobile,smsToken:this.userinfo.smsToken,smsCode:this.userinfo.smsCode};this.$emit("lReceiveCoupon",e)},handleSmsSuccess:function(e){this.userinfo.dragCaptchaToken=e,this.handleSendSms()}})},m=n("a6c2"),v=Object(m.a)(p,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"coupon-receive-login"},[n("div",{staticClass:"receive-login-input"},[n("van-field",{attrs:{border:!1,"error-message":e.errorMessage.mobile,type:"number",placeholder:"请输入手机号码",clearable:""},on:{blur:function(t){return e.validateMobileOrPsw("mobile")},keyup:function(t){return e.validatedChecker()}},model:{value:e.userinfo.mobile,callback:function(t){e.$set(e.userinfo,"mobile",t)},expression:"userinfo.mobile"}})],1),e.dragEnable?n("div",{staticClass:"mobile-drag"},[n("div",{staticClass:"mobile-drag-content"},[e.dragEnable?n("e-drag",{key:e.dragKey,ref:"dragComponent",attrs:{"limit-type":"receive_coupon"},on:{success:e.handleSmsSuccess}}):e._e()],1)]):e._e(),n("div",{staticClass:"receive-login-input"},[n("van-field",{ref:"smsCode",attrs:{border:!1,type:"number",placeholder:"请输入验证码",clearable:"",maxlength:"6"},model:{value:e.userinfo.smsCode,callback:function(t){e.$set(e.userinfo,"smsCode",t)},expression:"userinfo.smsCode"}},[n("div",{class:["code-btn",e.cansentCode?"":"code-btn--disabled"],attrs:{slot:"button"},on:{click:e.clickSmsBtn},slot:"button"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.count.showCount,expression:"!count.showCount"}]},[e._v("发送验证码")]),n("span",{directives:[{name:"show",rawName:"v-show",value:e.count.showCount,expression:"count.showCount"}]},[e._v(e._s(e.count.num)+" s")])])])],1),n("div",{class:["receive-login__btn",e.btnDisable?"disabled__btn":""],on:{click:function(t){return e.handleSubmit(e.handleSubmitSuccess)}}},[e._v("\n    立即领取\n  ")]),e._m(0)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"receive-login__text"},[t("span",{staticClass:"receive-login-tools"},[this._v("新用户领取将为您自动注册")])])}],!1,null,null,null).exports,g=n("8813"),b=n("8b9d"),y=n("5118"),C={name:"FastReceive",components:{fastLogin:v},mixins:[g.a,b.a],data:function(){return{coupons:null,currentUserCoupon:null,login:!1,canuse:!1,hasReceive:!1,receiveFail:!1,failmessage:"优惠券已失效",successmessage:"",loginMethods:!1}},created:function(){this.getCouponInfo()},computed:Object(o.a)({},Object(r.d)({user:function(e){return e.user},isLoading:function(e){return e.isLoading},settings:function(e){return e.settings},couponSwitch:function(e){return e.couponSwitch}}),{username:{get:function(){if(this.$store.state.token)return this.user.verifiedMobile?this.user.verifiedMobile:this.user.nickname}}}),filters:{couponType:function(e){return"discount"==e?"折":"元"}},methods:{getCouponInfo:function(){var e=Object(u.a)(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$route.params.token,e.next=3,a.a.getCouponInfo({query:{token:t}}).then((function(e){n.coupons=e,!n.cantUseCoupon(e)&&n.isLogin()})).catch((function(e){i.a.fail(e.message)}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),isLogin:function(){if(this.$store.state.token){this.login=!0;var e={token:this.$route.params.token};this.newReceiveCoupon(e)}},couponType:function(e){var t=e.targetDetail.numType,n=e.targetDetail.product;if("single"===t)switch(n){case"course":case"classroom":return"指定商品";case"vip":return"指定会员";default:return""}else if("all"===t)switch(n){case"course":return"全部课程";case"classroom":return"全部班级";case"all":return"全部商品";case"vip":return"全部会员";default:return""}else switch(n){case"course":case"classroom":return"部分商品";default:return""}},newReceiveCoupon:function(e,t){var n=this;a.a.pluginsReceiveCoupon({data:e}).then((function(e){if(t)return i.a.success("领取成功，正在跳转到详情页..."),void Object(y.setTimeout)((function(){n.useCoupon()}),3e3);n.currentUserCoupon=e,n.successmessage="领取成功，优惠券已放入",n.hasReceive=!0})).catch((function(e){t?"5004507"==e.code?(i.a.success("您已领取过该优惠券，正在跳转到详情页..."),Object(y.setTimeout)((function(){n.useCoupon()}),3e3)):i.a.fail("领取失败，"+e.message):"5004507"==e.code?(n.successmessage="您已领取过，优惠券已放入",n.hasReceive=!0):(n.receiveFail=!0,n.failmessage="领取失败，"+e.message)}))},useCoupon:function(){null!=this.currentUserCoupon&&this.currentUserCoupon.deadline&&this.isOld(this.currentUserCoupon.deadline)?i.a.fail("优惠券已过期"):this.hasreceiveCoupon(this.coupons)},lReceiveCoupon:function(e,t){var n={token:this.$route.params.token};this.loginMethods=!0,this.newReceiveCoupon(n,!0)},isOld:function(e){var t=new Date,n=new Date(Date.parse(e));return t.getTime()>n.getTime()+864e5},cantUseCoupon:function(e){return null!=e.currentUserCoupon?(this.currentUserCoupon=e.currentUserCoupon,this.successmessage="您已领取过该批次优惠券，优惠券已放入",this.hasReceive=!0,this.canuse=!1,!0):0==Number(e.unreceivedNum)?(this.failmessage="优惠券已领完",this.receiveFail=!0,this.canuse=!1,!0):e.deadline&&this.isOld(e.deadline)?(this.failmessage="优惠券已过期",this.receiveFail=!0,this.canuse=!1,!0):(this.canuse=!0,!1)}}},_=Object(m.a)(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.coupons?n("div",{staticClass:"coupon-receive"},[e.isLoading?n("e-loading"):e._e(),n("div",{staticClass:"coupon-receive-title text-overflow"},[e._v("\n    "+e._s(e.settings.name)+"\n  ")]),n("div",{staticClass:"coupon-receive-ticket"},[n("div",{staticClass:"ticket-discount"},[n("span",{staticClass:"rate"},[e._v(e._s(parseFloat(e.coupons.rate)))]),e._v(e._s(e._f("couponType")(e.coupons.type))+"\n      "),n("span",[e._v("优惠券")])]),n("div",{staticClass:"ticket-expire text-overflow"},["day"===e.coupons.deadlineMode?n("span",[null!=e.currentUserCoupon?n("span",[e._v("\n          优惠券有效至："+e._s(e.receiveTimeExpire(e.currentUserCoupon.deadline))+"\n        ")]):e._e(),null==e.currentUserCoupon?n("span",[e._v("\n          领取后"+e._s(e.coupons.fixedDay)+"天内有效\n        ")]):e._e()]):e._e(),"time"===e.coupons.deadlineMode?n("span",[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.hasReceive,expression:"!hasReceive"}]},[e._v("领券截止日期：")]),n("span",{directives:[{name:"show",rawName:"v-show",value:e.hasReceive,expression:"hasReceive"}]},[e._v("优惠券有效至：")]),e._v("\n        "+e._s(e.receiveTimeExpire(e.coupons.deadline))+"\n      ")]):e._e()]),n("div",{staticClass:"ticket-range text-overflow"},[e._v("适用于："+e._s(e.couponType(e.coupons)))])]),e.hasReceive&&!e.loginMethods&&e.couponSwitch?n("div",{staticClass:"receive-status"},[n("img",{staticClass:"status-icon",attrs:{src:"static/images/coupon-yes.png"}}),n("div",{staticClass:"status-text"},[e._v(e._s(e.successmessage))]),n("div",{staticClass:"status-user"},[e._v(e._s(e.username)+"账户")]),n("div",{staticClass:"status__btn",on:{click:function(t){return e.useCoupon()}}},[e._v("立即使用")])]):e._e(),e.receiveFail&&!e.loginMethods||!e.couponSwitch?n("div",{staticClass:"receive-status"},[n("img",{staticClass:"status-icon",attrs:{src:"static/images/coupon-no.png"}}),n("div",{staticClass:"status-text"},[e._v(e._s(e.failmessage))])]):e._e(),!e.login&&e.canuse&&e.couponSwitch?n("fast-login",{on:{lReceiveCoupon:e.lReceiveCoupon}}):e._e()],1):e._e()}),[],!1,null,null,null).exports,k={name:"PassReceive",mixins:[g.a,b.a],data:function(){return{item:{},message:"",isReceive:!0}},computed:Object(o.a)({couponStatus:function(){return Object.keys(this.item).length?"coupon-receive-success":""}},Object(r.d)(["couponSwitch"])),created:function(){var e=this;if(this.couponSwitch){var t=this.$route.params.token;this.$store.state.token?t&&a.a.receiveCoupon({data:{token:t}}).then((function(t){e.item=t,e.message="恭喜您成功领取了一张优惠券！"})).catch((function(t){e.message="优惠券领取失败！",i.a.fail(t.message)})):this.$router.push({name:"login",query:{redirect:this.$route.fullPath}})}else i.a.fail("优惠券已失效")}},w={components:{fastReceive:_,passReceive:Object(m.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"coupon-receive-page"},[n("div",{class:["coupon-card-bg","clearfix",e.couponStatus]},[n("div",{staticClass:"coupon-info"},[e._v(e._s(e.message))]),Object.keys(e.item).length?n("div",{staticClass:"e-coupon__body"},[n("div",{staticClass:"e-coupon__header clearfix"},[n("span",{staticClass:"e-coupon__price",domProps:{innerHTML:e._s(e.priceHtml(e.item))}}),n("div",{staticClass:"e-coupon__name"},[n("div",{staticClass:"text-overflow text-14 coupon-name"},[e._v(e._s(e.item.name))]),e.item.deadlineMode&&"time"!==e.item.deadlineMode?e._e():n("span",{staticClass:"text-10"},[e._v(e._s(e.timeExpire(e.item.createdTime,e.item.deadline)))]),"day"!==e.item.deadlineMode||e.item.currentUserCoupon?e._e():n("span",{staticClass:"text-10"},[e._v("领取后"+e._s(e.item.fixedDay)+"天内有效")]),"day"===e.item.deadlineMode&&e.item.currentUserCoupon?n("span",{staticClass:"text-10"},[e._v(e._s(e.timeExpire(e.item.createdTime,e.item.currentUserCoupon.deadline)))]):e._e()]),n("span",{staticClass:"coupon-button",on:{click:function(t){return e.couponHandle(e.item,e.isReceive)}}},[e._v("去使用")])]),n("div",{staticClass:"e-coupon__middle"}),n("div",{staticClass:"e-coupon__bottom text-overflow"},[e._v("\n        可用范围："+e._s(e.scopeFilter(e.item))+"\n      ")])]):e._e()])])}),[],!1,null,null,null).exports},data:function(){return{sitePlugins:0,cloudSetting:0}},created:function(){this.getsitePlugins()},computed:Object(o.a)({},Object(r.d)({isLoading:function(e){return e.isLoading}})),methods:{getsitePlugins:function(){var e=this;a.a.sitePlugins({query:{pluginName:"coupon"}}).then((function(t){Object.keys(t).length>0&&(c("2.2.10",t.version)?e.sitePlugins=1:e.sitePlugins=2,e.getsettingsCloud())})).catch((function(e){i.a.fail(e.message)}))},getsettingsCloud:function(){var e=this;a.a.settingsCloud().then((function(t){t.sms_enabled?e.cloudSetting=1:e.cloudSetting=2})).catch((function(e){i.a.fail(e.message)}))}}},T=Object(m.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"receive-all"},[e.isLoading?n("e-loading"):e._e(),1==e.cloudSetting&&1==e.sitePlugins?n("fast-receive"):e._e(),2==e.cloudSetting||2==e.sitePlugins?n("pass-receive"):e._e()],1)}),[],!1,null,null,null);t.default=T.exports},d863:function(e,t,n){"use strict";n("a481");var i=n("7067");t.a={data:function(){return{redirect:""}},created:function(){this.redirect=decodeURIComponent(this.$route.fullPath)},methods:{afterLogin:function(){var e=this,t=this.$route.query.redirect?decodeURIComponent(this.$route.query.redirect):"/",n=this.$route.query.skipUrl?decodeURIComponent(this.$route.query.skipUrl):"",o=this.$route.query.callbackType,r=this.$route.query.activityId,a=decodeURIComponent(this.$route.query.callback);setTimeout((function(){if(o)switch(o){case"marketing":Object(i.a)(r,a)}else n?e.$router.replace({path:t,query:{backUrl:n}}):e.$router.replace({path:t})}),2e3)}}}},f13d:function(e,t,n){"use strict";var i=n("75fc"),o=(n("e7e5"),n("d399")),r=n("db72"),a=(n("c5f6"),n("3ce7")),s={props:{tips:{type:String,default:"拖动左边滑块完成上方拼图"},limitType:{type:String,default:""}},data:function(){return{imgInfo:{url:"",jigsaw:"",token:""},dragState:{left:0,width:0,currentX:0,currentLeft:0,btnWidth:0,maskWidth:0},dragToEnd:!1}},created:function(){this.initDragCaptcha()},mounted:function(){var e=this.$refs.bar,t=this.$refs.dragBtn,n=(this.$refs.drag,e.getBoundingClientRect());Object.assign(this.dragState,{left:Number(n.left.toFixed(2)),width:e.clientWidth,btnWidth:t.offsetWidth/2})},methods:{initDragCaptcha:function(){var e=this,t={};this.limitType&&(t={limitType:this.limitType}),a.a.dragCaptcha({data:t}).then((function(t){e.imgInfo=Object(r.a)({},t),Object.assign(e.dragState,{currentLeft:0,maskWidth:0}),e.dragToEnd=!1})).catch((function(e){o.a.fail(e.message)}))},handletTouchEnd:function(){var e=this;if(!this.dragToEnd&&this.dragState.currentLeft){var t=this.getToken();this.dragToEnd=!0,a.a.dragValidate({query:{token:t}}).then((function(n){o.a.success("验证成功"),e.$emit("success",t)})).catch((function(t){o.a.fail(t.message),e.initDragCaptcha()}))}},handleTouchMove:function(e){if(!this.dragToEnd){e.preventDefault();var t=this.$refs.dragBtn,n=(this.$refs.dragImgBg,this.dragState),i=e.clientX?e.clientX.toFixed(2):e.targetTouches[0].pageX.toFixed(2)-this.$refs.drag.offsetLeft,o=(i-n.left-n.btnWidth).toFixed(2);o<0&&(o=0),i>n.width+this.$refs.drag.offsetLeft&&(o=n.width-this.$refs.dragImg.width),Object.assign(this.dragState,{currentLeft:o,maskWidth:(Number(o)+t.offsetWidth/2).toFixed(2)})}},calPositionX:function(){var e=this.$refs.dragImgBg,t=(e.naturalWidth/e.width).toFixed(2);return(Number(this.dragState.currentLeft).toFixed(2)*t).toFixed(2)},getToken:function(){var e={token:this.imgInfo.token,captcha:this.calPositionX()};return Object(i.a)(btoa(JSON.stringify(e))).reverse().join("")}}},c=n("a6c2"),u=Object(c.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"drag",staticClass:"e-drag"},[n("div",{staticClass:"e-drag-section"},[n("div",{staticClass:"e-drag-img"},[n("img",{ref:"dragImgBg",attrs:{src:e.imgInfo.url,alt:""}}),n("img",{ref:"dragImg",staticClass:"e-drag-img__dragable",style:{left:e.dragState.currentLeft+"px"},attrs:{src:e.imgInfo.jigsaw,alt:""}})]),n("div",{ref:"bar",staticClass:"e-drag-bar"},[n("span",[e._v(e._s(e.tips))]),n("div",{staticClass:"e-drag-bar__mask",style:{width:e.dragState.maskWidth+"px"}}),n("div",{ref:"dragBtn",staticClass:"e-drag-btn",style:{left:e.dragState.currentLeft+"px"},on:{touchend:e.handletTouchEnd,touchmove:e.handleTouchMove}},[n("img",{attrs:{src:"static/images/drag.png",alt:""}})])])])])}),[],!1,null,null,null);t.a=u.exports}}]);