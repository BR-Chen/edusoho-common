(window.webpackJsonp=window.webpackJsonp||[]).push([["course"],{"326d":function(t,e,s){"use strict";s("8e6e"),s("ac6a"),s("456d"),s("a481"),s("3b2b");var i=s("bd86"),n=(s("c5f6"),s("3ce7")),a=s("2f62");function r(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}var o={name:"Reviews",data:function(){return{value:0,message:"",reviews:null}},props:{details:{type:Object,value:function(){}}},watch:{details:{handler:function(t){this.reviews=t.myReview},immediate:!0,deep:!0}},methods:{onSubmit:function(){var t=this;if(0!=this.value)if(this.message.trim()){var e,s;Number(this.details.parentId)?(s="course",e=this.details.id):(s="goods",e=this.details.goodsId);var i={targetType:s,targetId:e,content:this.message,rating:this.value,userId:this.user.id};n.a.createReview({data:i}).then((function(e){t.reviews=e}))}else this.$toast("评价内容不能为空~");else this.$toast("评分不能为空~")},onResetReviews:function(){this.message=this.reviews.content,this.value=1*this.reviews.rating,this.reviews=null}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?r(Object(s),!0).forEach((function(e){Object(i.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},Object(a.e)({user:function(t){return t.user}})),filters:{createdTime:function(t){var e=new RegExp("-","g"),s=t.replace(e,"/"),i=(s=s.slice(0,-9)).slice(11,13),n="";i>=0&&i<6?n="凌晨":i>=6&&i<12?n="上午":i>=12&&i<18?n="下午":i>=18&&i<24&&(n="晚上");var a=new RegExp("T","g");return s.replace(a," "+n)}}},c=s("a6c2"),l=Object(c.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-reviews"},[s("div",{staticClass:"course-reviews__heading"},[t._v("\n    我的评价\n    "),null!==t.reviews?s("span",{staticClass:"pull-right reset-reviews",on:{click:t.onResetReviews}},[t._v("重新评价")]):t._e()]),s("div",{staticClass:"course-reviews__body"},[null===t.reviews?s("div",{staticClass:"text-center"},[s("van-rate",{attrs:{size:25,color:"#ffd21e","void-icon":"star","void-color":"#eee"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("van-field",{staticStyle:{border:"1px solid #eee",padding:"10px","margin-top":"10px"},attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"500",placeholder:"请输入评价","show-word-limit":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),s("van-button",{staticStyle:{"border-radius":"8px","margin-top":"10px",background:"#408ffb",color:"#fff"},attrs:{type:"default",size:"small"},on:{click:t.onSubmit}},[t._v("提交评价")])],1):s("div",{staticClass:"clearfix"},[s("div",{staticClass:"pull-left course-reviews__avatar"},[s("img",{attrs:{src:t.reviews.user.avatar.large,alt:""}})]),s("div",{staticClass:"pull-left course-reviews__content"},[s("div",{staticClass:"reviews-content__header clearfix"},[s("span",{staticClass:"reviews-content__header__nickname pull-left"},[t._v("\n            "+t._s(t.reviews.user.nickname)+"\n          ")]),s("span",{staticClass:"reviews-content__header__time pull-right"},[t._v("\n            "+t._s(t._f("createdTime")(t.reviews.createdTime))+"\n          ")])]),s("div",{staticClass:"reviews-content_rating"},[s("van-rate",{staticClass:"plan-rate",attrs:{readonly:"",value:1*t.reviews.rating,gutter:"2"}})],1),s("div",{staticClass:"reviews-content_text"},[t._v(t._s(t.reviews.content))])])])])])}),[],!1,null,null,null);e.a=l.exports},"410d":function(t,e,s){"use strict";var i={name:"Service",props:["services"]},n=s("a6c2"),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-detail__service"},[s("span",[t._v("承诺服务：")]),t._l(t.services,(function(e){return[s("span",{staticClass:"course-detail__service-icon"},[t._v(t._s(e.shortName))])]}))],2)}),[],!1,null,null,null);e.a=a.exports},"49a2":function(t,e,s){"use strict";var i={name:"EPopup",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},contentClass:{type:String,default:""}},computed:{popupShow:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},methods:{toggleClick:function(){this.popupShow=!1}}},n=s("a6c2"),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{staticClass:"e-popup",attrs:{position:"bottom"},model:{value:t.popupShow,callback:function(e){t.popupShow=e},expression:"popupShow"}},[s("div",{staticClass:"e-popup__title"},[s("span",{staticClass:"name"},[t._v(t._s(t.title))]),s("i",{staticClass:"icon h5-icon h5-icon-guanbi",on:{click:t.toggleClick}})]),s("div",{staticClass:"e-popup__content",class:t.contentClass},[t._t("default")],2)])}),[],!1,null,null,null).exports,r=s("639e"),o={name:"EMiniCoupon",mixins:[s("8813").a],props:{item:{type:Object,default:function(){return{}}}}},c=Object(n.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("van-tag",{staticClass:"mini-coupon ml5",attrs:{type:"danger"}},[this._v(this._s(this.priceHtml(this.item,!1)))])}),[],!1,null,null,null).exports,l=s("8b9d"),u=s("a262"),d={name:"Onsale",components:{coupon:r.a,miniCoupon:c,EPopup:a},mixins:[l.a,u.a],props:["unreceivedCoupons","miniCoupons","activities"],data:function(){return{couponListShow:!1}}},h=Object(n.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("e-panel",{attrs:{title:"优惠"}},[t.activities.groupon?s("van-cell",{staticClass:"course-detail__cell",attrs:{"is-link":""},on:{click:function(e){return t.activityHandle(t.activities.groupon.id)}}},[s("template",{slot:"title"},[s("span",{staticClass:"text-12"},[t._v("拼团：")]),s("van-tag",{staticClass:"ml5",staticStyle:{"background-color":"#ffaa00"}},[t._v("拼团")]),s("span",{staticClass:"text-12 dark"},[t._v("跟好友一起买更划算哦！")])],1)],2):t._e(),t.activities.cut?s("van-cell",{staticClass:"course-detail__cell",attrs:{"is-link":""},on:{click:function(e){return t.activityHandle(t.activities.cut.id)}}},[s("template",{slot:"title"},[s("span",{staticClass:"text-12"},[t._v("砍价：")]),s("van-tag",{staticClass:"ml5",staticStyle:{"background-color":"#ffaa00"}},[t._v("砍价")]),s("span",{staticClass:"text-12 dark"},[t._v("最低可砍至1分钱！")])],1)],2):t._e(),t.unreceivedCoupons.length?s("van-cell",{staticClass:"course-detail__cell",attrs:{"is-link":""},on:{click:function(e){t.couponListShow=!0}}},[s("template",{slot:"title"},[s("span",{staticClass:"text-12"},[t._v("领券：")]),t._l(t.miniCoupons,(function(t,e){return s("mini-coupon",{key:e,attrs:{item:t}})}))],2)],2):t._e(),s("e-popup",{staticClass:"coupon-popup white-background",attrs:{show:t.couponListShow,title:"优惠券"},on:{"update:show":function(e){t.couponListShow=e}}},[t._l(t.unreceivedCoupons,(function(e,i){return s("coupon",{key:i,attrs:{index:i,coupon:e,"show-button":!0},on:{couponHandle:function(e){return t.couponHandle(e)}}})})),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.unreceivedCoupons.length,expression:"!unreceivedCoupons.length"}],staticClass:"coupon-empty"},[s("img",{staticClass:"empty-img",attrs:{src:"static/images/coupon_empty.png"}}),s("div",{staticClass:"empty-text"},[t._v("暂无优惠券")])])],2)],1)}),[],!1,null,null,null);e.a=h.exports},"504c":function(t,e,s){var i=s("9e1e"),n=s("0d58"),a=s("6821"),r=s("52a7").f;t.exports=function(t){return function(e){for(var s,o=a(e),c=n(o),l=c.length,u=0,d=[];l>u;)s=c[u++],i&&!r.call(o,s)||d.push(t?[s,o[s]]:o[s]);return d}}},"639e":function(t,e,s){"use strict";s("c5f6");var i={name:"ECoupon",mixins:[s("8813").a],props:{showButton:{type:Boolean,default:!0},showSelecet:{type:Boolean,default:!1},coupon:{type:Object,default:function(){return{}}},index:{type:Number,default:-1},active:{type:Number,default:-1}},data:function(){return{}},created:function(){},methods:{onSelect:function(){this.showSelecet&&this.$emit("chooseItem",{index:this.index,itemData:this.coupon})},couponHandle:function(){this.$emit("couponHandle",this.coupon)}}},n=s("a6c2"),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-container e-coupon",on:{click:t.onSelect}},[s("div",{staticClass:"e-coupon__container clearfix e-coupon-single"},[s("div",{key:t.index,staticClass:"e-coupon__body"},[s("div",{staticClass:"e-coupon__header clearfix"},[s("span",{staticClass:"e-coupon__price",domProps:{innerHTML:t._s(t.priceHtml(t.coupon))}}),s("div",{staticClass:"e-coupon__name"},[s("div",{staticClass:"text-overflow text-14 coupon-name"},[t._v("\n            "+t._s(t.coupon.name||"优惠券")+"\n          ")]),t.coupon.deadlineMode&&"time"!==t.coupon.deadlineMode?t._e():s("span",{staticClass:"text-10"},[t._v(t._s(t.timeExpire(t.coupon.createdTime,t.coupon.deadline)))]),"day"!==t.coupon.deadlineMode||t.coupon.currentUserCoupon?t._e():s("span",{staticClass:"text-10"},[t._v("领取后"+t._s(t.coupon.fixedDay)+"天内有效")]),"day"===t.coupon.deadlineMode&&t.coupon.currentUserCoupon?s("span",{staticClass:"text-10"},[t._v(t._s(t.timeExpire(t.coupon.createdTime,t.coupon.currentUserCoupon.deadline)))]):t._e()]),t.coupon.currentUserCoupon?s("div",{staticClass:"stamp"}):t._e(),t.showSelecet?s("div",{staticClass:"e-coupon__select-circle"},[s("i",{staticClass:"select-icon",class:t.index===t.active?"h5-icon h5-icon-check":""})]):t._e(),t.showButton&&!t.coupon.currentUserCoupon?s("span",{staticClass:"coupon-button",on:{click:t.couponHandle}},[t._v("领券")]):t._e()]),s("div",{staticClass:"e-coupon__middle"}),s("div",{staticClass:"e-coupon__bottom text-overflow"},[t._v("\n        可用范围："+t._s(t.scopeFilter(t.coupon))+"\n      ")])])])])}),[],!1,null,null,null);e.a=a.exports},8615:function(t,e,s){var i=s("5ca1"),n=s("504c")(!1);i(i.S,"Object",{values:function(t){return n(t)}})},"86ee":function(t,e,s){"use strict";var i={name:"MoreMask",props:{maxHeight:{default:288},disabled:{default:!1},forceShow:{type:Boolean,default:!1},text:{type:Object,default:function(){return{content:"",lineHeight:17,paddingTop:100,align:"center"}}}},data:function(){return{realHeight:0,intervalTime:5e3,intervalId:void 0}},computed:{exccedHeight:function(){return this.realHeight>this.maxHeight||this.forceShow},heightStyle:function(){return{maxHeight:!this.exccedHeight||this.disabled||this.forceShow?"none":"".concat(this.maxHeight,"px"),paddingBottom:this.forceShow||this.exccedHeight&&!this.disabled?"25px":"0"}},textStyle:function(){return{paddingTop:"".concat(this.text.paddingTop,"px"),lineHeight:"".concat(this.text.lineHeight,"px"),textAlign:"".concat(this.text.align)}}},mounted:function(){var t=this;this.intervalId=setInterval((function(){t.intervalTime-=500,t.intervalTime<0?clearInterval(t.intervalId):t.realHeight=t.$el.getBoundingClientRect().height}),500)},methods:{maskLoadMore:function(){this.$emit("maskLoadMore")}}},n=s("a6c2"),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"more-mask"},[s("div",{staticClass:"more-mask__body",style:t.heightStyle},[t._t("default")],2),t.disabled?t._e():s("div",{directives:[{name:"show",rawName:"v-show",value:t.exccedHeight,expression:"exccedHeight"}],staticClass:"more-mask__footer",style:t.textStyle,on:{touchstart:function(e){return e.preventDefault(),t.maskLoadMore(e)}}},[t._v("\n    "+t._s(t.text.content||"点击查看更多")+"\n  ")])])}),[],!1,null,null,null);e.a=a.exports},8813:function(t,e,s){"use strict";s("28a5"),s("6b54"),s("c5f6");var i=s("0d25");e.a={methods:{timeExpire:function(t,e){return t?(t=Object(i.formatFullTime)(new Date(t)),e=Object(i.formatFullTime)(new Date(e)),"".concat(t," 至 ").concat(e)):(e=Object(i.formatFullTime)(new Date(e)),"有效期截止：".concat(e))},timeCalculation:function(t){var e=(new Date).setDate((new Date).getDate()+Number(t));return e=Object(i.formatFullTime)(new Date(e)),"有效期至：".concat(e)},priceHtml:function(t){var e=t.rate,s=t.type,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=parseInt(e,10),a=n.toString().length>3?"text-16 ml-5":"",r=Number(e).toFixed(2).split(".")[1];r=0===Number(r)?"":".".concat(r);var o="discount"===s?"折":"元";return i?'<span class="'.concat(a,'">').concat(n,'</span><span class="text-14">').concat(r+o,"</span>"):n+r+o},scopeFilter:function(t){var e=t.targetDetail,s=e.numType,i=e.product,n="";if("single"===s)switch(i){case"course":case"classroom":n="指定商品";break;case"vip":n="指定会员";break;default:n=""}else if("all"===s)switch(i){case"course":n="全部课程";break;case"classroom":n="全部班级";break;case"all":n="全部商品";break;case"vip":n="全部会员";break;default:n=""}else switch(i){case"course":case"classroom":n="部分商品";break;default:n=""}return n},handleClick:function(t){this.$emit("buttonClick",t)},receiveTimeExpire:function(t){return Object(i.formatchinaTime)(new Date(t))}}}},"8b9d":function(t,e,s){"use strict";s("6762"),s("2fdb"),s("ac6a"),s("8615"),s("e7e5");var i=s("d399"),n=s("3ce7"),a={classroom:"classroom",course:"course",vip:"vip",all:"all"};e.a={methods:{couponHandle:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.$store.state.token)if(t.currentUserCoupon||e)this.hasreceiveCoupon(t);else{var s=t.token;n.a.receiveCoupon({data:{token:s}}).then((function(e){t.currentUserCoupon=e,i.a.success({message:"领取成功",duration:2e3})})).catch((function(e){i.a.fail(e.message),t.unreceivedNum="0"}))}else this.$router.push({name:"login",query:{redirect:this.$route.fullPath}})},hasreceiveCoupon:function(t){var e=this,s=t.targetDetail.product,n=t.targetDetail.numType;if(Object.values(a).includes(s)){if("single"===n){var r=t.target.id;if(s===a.vip)return void this.$router.push({path:"/vip",query:{id:r}});this.getPathParams(s,r).then((function(t){var i=t.id;i&&e.$router.push({path:"/".concat(s,"/").concat(i)})}))}else if(["multi","all"].indexOf(n)>-1){if("vip"===s)return void this.$router.push({path:"/".concat(t.targetDetail.product)});if("all"===s)return void this.$router.push({path:"/"});this.$router.push({path:"/".concat(t.targetDetail.product,"/explore")})}}else i.a.fail("暂不支持查看：".concat(s,"类型商品"))},getPathParams:function(t,e){return t!==a.course?Promise.resolve({id:e}):n.a.getCourseByCourseSet({query:{id:e}}).then((function(t){return t.length&&t[0]?{id:t[0].id}:Promise.reject({message:"当前课程不存在了"})})).catch((function(t){i.a.fail(t.message)}))}}}},a262:function(t,e,s){"use strict";var i=s("7067");e.a={methods:{activityHandle:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i.a)(t,e,s)}}}},d0b2:function(t,e,s){"use strict";var i=s("e656"),n=s("86ee"),a={name:"ReviewList",components:{review:i.a,moreMask:n.a},props:["reviews","title","targetId","defaulValue","type"],data:function(){return{maxShowNum:5}},computed:{isClass:function(){return"classroom"===this.type}},methods:{loadMore:function(){this.$router.push({path:"/comment/".concat(this.targetId),query:{type:this.type}})}}},r=s("a6c2"),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("e-panel",{attrs:{title:t.title,"need-flex":!1,"defaul-value":t.defaulValue}},[t.reviews.length?s("moreMask",{attrs:{"max-height":400},on:{maskLoadMore:t.loadMore}},[t._l(t.reviews,(function(e){return[s("review",{attrs:{review:e,"is-class":t.isClass,course:e.course}})]}))],2):t._e()],1)}),[],!1,null,null,null);e.a=o.exports},e656:function(t,e,s){"use strict";s("c5f6");var i=s("86ee"),n=s("0d25"),a={name:"Review",components:{moreMask:i.a},filters:{userName:function(t){return t&&t.nickname||"匿名用户"},avatar:function(t){return t&&t.avatar&&t.avatar.middle},time:function(t,e){var s=new Date(t);return"simple"===e?Object(n.formatSimpleTime)(s):"complete"===e?Object(n.formatCompleteTime)(s):t}},props:{review:{type:Object,default:function(){return{}}},course:{type:Object,default:function(){return{}}},disableMask:{type:Boolean,default:!0},isClass:{type:Boolean,default:!0},timeFormat:{type:String,default:"simple"}},data:function(){return{loadAllReview:!1}},computed:{posts:function(){return this.review&&this.review.posts||[]},rating:{get:function(){return Number(this.review.rating)},set:function(){}},emptyRating:{get:function(){return this.rating>=0?Number(5-this.rating):5},set:function(){}},textOption:function(){return{paddingTop:70,lineHeight:25,align:"right",content:"显示全部"}},courseTitle:function(){return this.isClass?"":this.course.displayedTitle}}},r=s("a6c2"),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"e-review"},[s("img",{staticClass:"e-review-avatar avatar-img",attrs:{src:t._f("avatar")(t.review.user),alt:""}}),s("div",{staticClass:"e-review-body"},[s("div",[s("span",{staticClass:"e-review-nickname text-14"},[t._v(t._s(t._f("userName")(t.review.user)))]),s("van-rate",{staticClass:"e-review-rating",attrs:{size:15,count:t.emptyRating,readonly:!0,color:"#B0BDC9"},model:{value:t.emptyRating,callback:function(e){t.emptyRating=e},expression:"emptyRating"}}),s("van-rate",{staticClass:"e-review-rating",attrs:{size:15,count:t.rating,readonly:!0,color:"#FFAA00"},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}})],1),s("div",{staticClass:"e-review-time text-12"},[t._v("\n      "+t._s(t._f("time")(t.review.createdTime,t.timeFormat))+"\n    ")]),t.disableMask?s("div",{staticClass:"e-review-content text-14"},[t._v("\n      "+t._s(t.review.content)+"\n    ")]):s("more-mask",{attrs:{text:t.textOption,"max-height":100,disabled:t.loadAllReview},on:{maskLoadMore:function(e){t.loadAllReview=!0}}},[s("div",{staticClass:"e-review-content text-14"},[t._v(t._s(t.review.content))])]),t.courseTitle?s("span",{staticClass:"e-review-origin text-12"},[t._v("来自："+t._s(t.courseTitle))]):t._e(),t._l(t.posts,(function(e){return s("div",{staticClass:"e-review__post"},[s("img",{staticClass:"e-review-avatar e-review__post-avatar avatar-img",attrs:{src:t._f("avatar")(e.user),alt:""}}),s("div",{staticClass:"e-review__post-body"},[s("span",{staticClass:"e-review-nickname text-14"},[t._v(t._s(t._f("userName")(e.user))+" 回复\n          "+t._s(t._f("userName")(t.review.user))+"：")]),s("div",{staticClass:"e-review-content text-14"},[t._v(t._s(e.content))])])])}))],2)])}),[],!1,null,null,null);e.a=o.exports},fd4a:function(t,e,s){"use strict";s.r(e),s("8e6e"),s("ac6a"),s("456d"),s("e7e5");var i=s("d399"),n=(s("c5f6"),s("bd86")),a=(s("a481"),s("e17f"),s("2241")),r=(s("7f7f"),s("96cf"),s("3b8d")),o=(s("4917"),s("b127")),c=s("202a"),l=s("410d"),u=s("2f62"),d=s("0d25"),h=s("3ce7");function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var f={components:{service:l.a},data:function(){return{items:[],isFree:!1,showNumberData:""}},created:function(){this.getGoodSettings()},watch:{selectedPlanId:{immediate:!0,handler:function(t){var e=this;this.items=this.details.courses.map((function(t,s){return e.$set(t,"active",!1),t.id===e.details.id&&(t.active=!0),t}))}},learnExpiryHtml:{immediate:!0,handler:function(t){var e=this.details.learningExpiryDate,s=e.expiryStartDate.slice(0,10),i=e.expiryEndDate.slice(0,10);this.$emit("getLearnExpiry",{val:t,startDateStr:s,endDateStr:i})}}},computed:m(m(m({},Object(u.e)("course",{details:function(t){return t.details},selectedPlanId:function(t){return t.selectedPlanId},joinStatus:function(t){return t.joinStatus}})),Object(u.e)(["courseSettings","vipSwitch"])),{},{learnExpiryHtml:function(){var t=this.details.member,e=this.details.learningExpiryDate,s=e.expiryMode,i=e.expiryStartDate.slice(0,10),n=e.expiryEndDate.slice(0,10);if(t)return"forever"==s?"长期有效":0!=t.deadline?t.deadline.slice(0,10)+"之前可学习":"长期有效";switch(s){case"forever":return"长期有效";case"end_date":return n+"之前可学习";case"days":return e.expiryDays+"天内可学习";case"date":return'<div class = "mt5">开课日期：'+i+"&nbsp;&nbsp;&nbsp;截止日期："+n+"</div>"}return""},buyExpiryTime:function(){var t=new Date(this.details.buyExpiryTime);return Object(d.formatFullTime)(t)},showStudent:function(){return!this.courseSettings||Number(this.courseSettings.show_student_num_enabled)},defaultPlan:function(){return 1===this.items.length&&!this.items[0].title},isDiscount:function(){if(!this.details.courseSet)return!1;var t=this.details.courseSet.discount;if(""!==t){var e=Number(t);return 10!==e&&(0===e||e)}return""}}),methods:m(m({},Object(u.c)("course",["getCourseLessons"])),{},{handleClick:function(t,e){var s=this;h.a.meCourseMember({query:{id:t.id}}).then((function(e){e.id?s.$router.push({path:"/course/".concat(t.id)}):s.$router.push({path:"/goods/".concat(t.goodsId,"/show"),query:{targetId:t.id}})})).catch((function(){s.$router.push({path:"/goods/".concat(t.goodsId,"/show"),query:{targetId:t.id}})}))},getGoodSettings:function(){var t=this;h.a.getSettings({query:{type:"goods"}}).then((function(e){t.showNumberData=e.show_number_data}))},filterPrice:function(){var t=this.details;return Number(t.isFree)||"0.00"===t.price?(this.isFree=!0,"免费"):(this.isFree=!1,"¥".concat(t.price))},toCertificate:function(t){this.$router.push({path:"/certificate/list/".concat(t)})}})},v=s("a6c2"),g=Object(v.a)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("e-panel",{attrs:{title:t.details.courseSet.title,type:t.details.hasCertificate}},[s("div",{staticClass:"course-detail__plan-price"},[s("span",{class:{isFree:t.isFree}},[t._v(t._s(t.filterPrice())+"\n        "),t.isDiscount?s("span",{staticClass:"original-price ml10"},[t._v("原价：￥"+t._s(t.details.originPrice))]):t._e()]),"join"===t.showNumberData?s("div",{staticClass:"pull-right study-num"},[s("i",{staticClass:"iconfont icon-people"}),t._v("\n        "+t._s(t.details.studentNum)+"\n      ")]):"visitor"===t.showNumberData?s("div",{staticClass:"pull-right study-num"},[s("i",{staticClass:"iconfont icon-visibility"}),t._v("\n        "+t._s(t.details.hitNum)+"\n      ")]):t._e()])]),t.defaultPlan?t._e():s("ul",{staticClass:"course-detail__plan"},[t._l(t.items,(function(e,i){return[e.title?s("li",{key:i,class:{active:e.active},on:{click:function(s){return t.handleClick(e,i)}}},[t._v("\n        "+t._s(e.title)+"\n      ")]):t._e()]}))],2),s("div",{staticClass:"course-detail__validity"},[t.details.vipLevel&&t.vipSwitch?s("div",{staticClass:"mb15"},[s("span",{staticClass:"mr20"},[t._v("会员免费")]),s("img",{staticClass:"vipIcon",attrs:{src:t.details.vipLevel.icon}}),s("router-link",{staticClass:"color-primary",attrs:{to:{path:"/vip",query:{id:t.details.vipLevel.id}}}},[t._v("\n        "+t._s(t.details.vipLevel.name)+"免费学")])],1):t._e(),t.details.services.length?s("service",{attrs:{services:t.details.services}}):t._e(),s("div",[s("span",{staticClass:"mr20"},[t._v("学习有效期")]),s("span",{staticClass:"dark",domProps:{innerHTML:t._s(t.learnExpiryHtml)}})]),0!=t.details.buyExpiryTime?s("div",{staticClass:"mt5"},[s("span",{staticClass:"mr20"},[t._v("购买截止日期")]),s("span",{staticClass:"validity orange"},[t._v(t._s(t.buyExpiryTime))])]):t._e()],1),t.details.hasCertificate?s("div",{staticClass:"course-detail__certificate",on:{click:function(e){return t.toCertificate(t.selectedPlanId)}}},[t._m(0),s("i",{staticClass:"van-icon van-icon-arrow pull-right"})]):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("span",{staticClass:"certificate-icon"},[this._v("证")]),this._v("证书")])}],!1,null,null,null).exports,b={name:"Teacher",props:["teacherInfo"]},y=Object(v.a)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("e-panel",{attrs:{title:"教师介绍"}},[t._l(t.teacherInfo,(function(e){return[s("div",{staticClass:"teacher-content"},[s("img",{staticClass:"avatar-img",attrs:{src:e.avatar.large}}),s("div",{staticClass:"teacher-cell"},[s("span",{staticClass:"dark font-family-PFM"},[t._v(t._s(e.nickname))]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.title,expression:"item.title"}],staticClass:"text-content"},[t._v(t._s(e.title))])])])]}))],2)}),[],!1,null,null,null).exports,w=(s("6b54"),{name:"SwiperDirectory",props:{item:{type:Array,default:function(){return[]}},slideIndex:{type:Number,default:0},hasChapter:{type:Boolean,default:!0}},data:function(){return{current:this.slideIndex||0}},watch:{slideIndex:function(t,e){t!=e&&(this.current=t||0)}},computed:{swiperWidth:function(){var t=window.innerWidth;return t<=500?265:t/1.5}},methods:{changeChapter:function(t){this.current=t,this.$emit("changeChapter",t)},handleChapter:function(t){this.$refs.chapterSwipe.swipeTo(t)}}}),_=Object(v.a)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"swiper-directory"},[s("van-swipe",{ref:"chapterSwipe",attrs:{"show-indicators":!1,loop:!1,touchable:!0,width:t.swiperWidth,"initial-swipe":t.slideIndex},on:{change:t.changeChapter}},t._l(t.item,(function(e,i){return s("van-swipe-item",{key:i},[0==e.isExist?s("div",{staticClass:"chapter nochapter",class:"swiper-directory-active",on:{click:function(e){return t.handleChapter(i)}}},[s("i",{staticClass:"iconfont icon-wuzhangjieliang"}),t._v("\n        无章节\n      ")]):t._e(),1==e.isExist?s("div",{staticClass:"chapter haschapter",class:[t.current===i?"swiper-directory-active":""],on:{click:function(e){return t.handleChapter(i)}}},[s("p",{staticClass:"chapter-title text-overflow"},[t._v("\n          第"+t._s(e.number)+t._s(t.hasChapter?"章":"节")+"："+t._s(e.title)+"\n        ")]),s("p",{staticClass:"chapter-des text-overflow"},[t._v("\n          "+t._s(t.hasChapter?"节("+e.unitNum+")":"")+" 课时("+t._s(e.lessonNum)+") 学习任务("+t._s(e.tasksNum)+")\n        ")])]):t._e()])})),1)],1)}),[],!1,null,null,null).exports,C={name:"UtilDirectory",props:{util:{type:Object,default:function(){}}}},x=Object(v.a)(C,(function(){var t=this.$createElement,e=this._self._c||t;return 1==this.util.isExist?e("div",{staticClass:"util-directory text-overflow"},[this._v("\n  第"+this._s(this.util.number)+"节："+this._s(this.util.title)+"\n")]):this._e()}),[],!1,null,null,null).exports,k=s("d863"),O=s("2164"),T=s("faa5");function j(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function S(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?j(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var I={name:"LessonDirectory",mixins:[k.a,O.a],props:{lesson:{type:Array,default:function(){return[]}},errorMsg:{type:String,default:""},taskId:{type:Number,default:-1},taskNumber:{type:Number,default:-1},unitNum:{type:Number,default:-1}},data:function(){return{currentTask:""}},watch:{taskId:{handler:"getTaskId",immediate:!0}},computed:S(S({},Object(u.e)("course",{details:function(t){return t.details},joinStatus:function(t){return t.joinStatus},selectedPlanId:function(t){return t.selectedPlanId}})),{},{hasLesson:function(){return this.lesson.length>0},isNoData:function(){return 0===this.taskNumber&&0===this.unitNum}}),mounted:function(){if(Object.keys(this.$route.query).length){var t=this.$route.query,e=t.sourceType,s=t.taskId;this.setSourceType({sourceType:e,taskId:s})}},methods:S(S({},Object(u.d)("course",{setSourceType:T.x})),{},{getTaskId:function(){this.currentTask=this.taskId},doubleLine:function(t){if(t.type)return"live"===t.type},showTask:function(t,e){var s=!0;return null==t.mode&&0==e&&(s=!1),"lesson"==t.mode&&(s=!1),s},lessonCellClick:function(t,e,s){if(this.$store.commit(T.y,""),!this.errorMsg||Number(t.isFree))if(t.lock)Object(i.a)("需要解锁上一个任务");else if("create"!==t.status&&"published"===t.status){var n={id:t.id};this.$store.commit("course/".concat(T.h),{nextTask:n}),!this.details.allowAnonymousPreview&&this.$router.push({name:"login",query:{redirect:this.redirect}}),this.joinStatus&&this.showTypeDetail(t)}else Object(i.a)("敬请期待");else this.$emit("showDialog")},showTypeDetail:function(t){if("published"===t.status)switch(t.type){case"video":"self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):Object(i.a)("暂不支持此类型");break;case"audio":this.setSourceType({sourceType:"audio",taskId:t.id});break;case"text":case"ppt":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type}});break;case"live":var e=!1;if(new Date>new Date(1e3*t.endTime)){if("videoGenerated"==t.activity.replayStatus)return void("self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):Object(i.a)("暂不支持此类型"));if("ungenerated"==t.activity.replayStatus)return void Object(i.a)("暂无回放");e=!0}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type,title:t.title,replay:e}});break;case"testpaper":var s=t.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:s,targetId:t.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;default:this.setSourceType({sourceType:"img",taskId:t.id}),this.copyPcUrl(t.courseUrl)}else Object(i.a)("敬请期待")},iconfont:function(t){switch(t.type){case"audio":return"icon-yinpin";case"doc":return"icon-wendang";case"exercise":return"icon-lianxi";case"flash":return"icon-flash";case"homework":return"icon-zuoye";case"live":return"icon-zhibo";case"ppt":return"icon-ppt";case"discuss":return"icon-taolun";case"testpaper":return"icon-kaoshi";case"text":return"icon-tuwen";case"video":return"icon-shipin";case"download":return"icon-xiazai";default:return""}},studyStatus:function(t){if(t.lock)return"icon-suo";if(null==t.result)return"icon-weixuexi";switch(t.result.status){case"finish":return"icon-yiwanchengliang";case"start":return"icon-weiwancheng";default:return""}},liveClass:function(t){return"published"!=t.status||"live"!=t.type?"nopublished":(new Date).getTime()>new Date(1e3*t.endTime)?"ungenerated"===t.activity.replayStatus?"end":"back":"play"}})};function D(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?D(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var E={name:"AfterjoinDirectory",components:{swiperDirectory:_,utilDirectory:x,lessonDirectory:Object(v.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.lesson,(function(e,i){return[t.hasLesson?s("div",{key:i,staticClass:"lesson-directory"},[s("div",{staticClass:"lesson-title",class:{"zb-ks":t.doubleLine(e.tasks[e.index])},attrs:{id:e.tasks[e.index].id},on:{click:function(s){return t.lessonCellClick(e.tasks[e.index],i,e.index)}}},[s("div",{staticClass:"lesson-title-r"},[s("div",{staticClass:"lesson-title-des"},[t.doubleLine(e.tasks[e.index])?t._e():s("div",{staticClass:"bl l22"},[s("span",{staticClass:"text-overflow ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id}},[s("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),t._v("\n                "+t._s(Number(e.tasks[e.index].isOptional)?"":"课时")+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n              ")])]),t.doubleLine(e.tasks[e.index])?s("div",{staticClass:"bl"},[s("div",{staticClass:"block-inline"},[s("span",{staticClass:"bl text-overflow ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id}},[s("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),t._v("\n                  "+t._s(Number(e.tasks[e.index].isOptional)?"":"课时")+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n                ")]),s("span",{staticClass:"bl zbtime"},[s("span",{class:[t.liveClass(e.tasks[e.index])]},[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))])])])]):t._e()])]),s("div",{staticClass:"lesson-title-l"},[Number(e.tasks[e.index].isOptional)?s("span",{staticClass:"elective-tag"},[t._v("\n            选修\n          ")]):t._e(),"live"!=e.tasks[e.index].type?s("span",[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))]):t._e(),s("i",{staticClass:"iconfont",class:t.studyStatus(e.tasks[e.index])})])]),e.tasks.length>1?s("div",{staticClass:"lesson-items"},[t._l(e.tasks,(function(e,n){return[t.showTask(e,n)?s("div",{key:n,staticClass:"litem",attrs:{id:e.id},on:{click:function(s){return t.lessonCellClick(e,i,n)}}},[s("div",{staticClass:"litem-r text-overflow",class:{lessonactive:t.currentTask==Number(e.id)}},[s("i",{staticClass:"iconfont",class:t.iconfont(e)}),t._v("\n              "+t._s(Number(e.isOptional)?"":"课时")+t._s(Number(e.isOptional)?e.title:e.number+":"+e.title)+"\n            ")]),s("div",{staticClass:"litem-l clearfix"},[s("span",{class:[t.liveClass(e),"text-overflow"]},[t._v(t._s(t._f("filterTaskTime")(e)))]),s("i",{staticClass:"iconfont",class:t.studyStatus(e)})])]):t._e()]}))],2):t._e()]):t._e()]})),t.isNoData?s("div",{staticClass:"noneItem"},[s("img",{staticClass:"notask",attrs:{src:"static/images/none.png"}}),s("p",[t._v("暂时还没有课时哦...")])]):t._e()],2)}),[],!1,null,null,null).exports},data:function(){return{scroll:"",item:[],level:3,chapterNum:0,unitNum:0,lessonNum:0,currentChapter:0,currentUnit:0,currentLesson:0,slideIndex:0,taskId:null,nodata:!1,allTask:{},allTaskId:[]}},computed:P(P({},Object(u.e)("course",{nextStudy:function(t){return t.nextStudy},selectedPlanId:function(t){return t.selectedPlanId},OptimizationCourseLessons:function(t){return t.OptimizationCourseLessons},details:function(t){return t.details},taskStatus:function(t){return t.taskStatus}})),{},{hasChapter:function(){return this.chapterNum>0}}),watch:{nextStudy:{handler:"getNextStudy",immediate:!0},selectedPlanId:{handler:"processItem",immediate:!0,deep:!0},taskStatus:{handler:"changeTaskStatus",immediate:!1}},methods:{getNextStudy:function(){if(this.nextStudy.nextTask){this.taskId=Number(this.nextStudy.nextTask.id);var t=this.allTask[this.taskId];if(!t)return;this.hasChapter?this.slideIndex=t.chapterIndex:this.slideIndex=t.unitIndex}},processItem:function(t){var e=this.OptimizationCourseLessons;this.resetData(),e.length?(this.nodata=!1,this.setItems(e),this.mapChild(this.item),this.startScroll(),this.$store.commit("course/".concat(T.l),this.allTask)):this.nodata=!0},resetData:function(){this.chapterNum=0,this.unitNum=0,this.lessonNum=0},setItems:function(t){this.level=1===t.length&&0==t[0].isExist?2:3,1===t.length?this.item=2===this.level?t[0].children:t:t.length>1&&(this.item=t)},mapChild:function(t){var e=this;t.map((function(s,i){"chapter"===s.type?e.formatChapter(s,t,i):"unit"===s.type?e.formatUnit(s,t,i):"lesson"===s.type?e.formatLesson(s,t,i):e.formatTask(s,t,i)}))},startScroll:function(){var t=this;this.$nextTick((function(){if(t.taskId){var e=document.getElementById("progress-bar"),s=document.getElementById("swiper-directory"),i=document.getElementById(t.taskId),n=e?e.offsetHeight:0,a=s?s.offsetHeight:0,r=(i?i.offsetTop:0)-n-44-a;r<document.documentElement.clientWidth||window.scrollTo({top:r})}}))},formatChapter:function(t,e,s){this.currentChapter=s,t.chapterNum=0,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.chapterNum+=1,this.computedNum(1,"chapterNum")),Array.isArray(t.children)&&t.children.length>0&&this.mapChild(t.children)},formatUnit:function(t,e,s){this.currentUnit=s,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.unitNum+=1,this.computedNum(1,"unitNum")),Array.isArray(t.children)&&t.children.length>0&&(this.computedNum(t.children.length,"lessonNum"),this.mapChild(t.children))},formatLesson:function(t,e,s){this.currentLesson=s,t.isExist&&(this.lessonNum+=1),t.tasks&&(this.computedNum(t.tasks.length-1,"tasksNum"),this.mapChild(t.tasks))},formatTask:function(t,e,s){Number(t.id)===this.taskId&&(this.slideIndex=3==this.level?this.currentChapter:this.currentUnit),this.getLessonIndex(t,s),t.chapterIndex=this.currentChapter,t.unitIndex=this.currentUnit,t.LessonIndex=this.currentLesson,t.level=this.level,t.taskIndex=s,this.allTask[t.id]=P({},t),this.allTaskId.push(t.id)},getLessonIndex:function(t,e){t.mode?"lesson"===t.mode&&this.getMainTask(t,e):this.getMainTask(t,0)},getMainTask:function(t,e){3===this.level?this.$set(this.item[this.currentChapter].children[this.currentUnit].children[this.currentLesson],"index",e):this.$set(this.item[this.currentUnit].children[this.currentLesson],"index",e)},computedNum:function(t,e){var s=3===this.level?this.currentChapter:this.currentUnit,i=this.item[s][e]+t;this.$set(this.item[s],e,i)},changeChapter:function(t){this.slideIndex=t},changeTaskStatus:function(t){if(t){"finish"===t&&this.changeLockStatus();var e=this.allTask[this.taskId],s={};if(2===e.level){var i=this.item[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];i.result?i.result.status=t:(s.status=t,i.result=s)}else{var n=this.item[e.chapterIndex].children[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];n.result?n.result.status=t:(s.status=t,n.result=s)}}},changeLockStatus:function(){if("lockMode"===this.details.learnMode){var t=this.allTaskId.indexOf(this.taskId.toString());if(t<this.allTaskId.length-1){var e=this.allTaskId[t+1],s=this.allTask[e];2===s.level?this.item[s.unitIndex].children[s.LessonIndex].tasks[s.taskIndex].lock=!1:this.item[s.chapterIndex].children[s.unitIndex].children[s.LessonIndex].tasks[s.taskIndex].lock=!1}}}}},N=Object(v.a)(E,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"afterjoin-directory"},[t.lessonNum>0?s("div",[t.chapterNum>0||t.unitNum>0?s("swiper-directory",{attrs:{id:"swiper-directory",item:t.item,"slide-index":t.slideIndex,"has-chapter":t.hasChapter},on:{changeChapter:t.changeChapter}}):t._e(),t.item.length>0?s("div",{attrs:{id:"lesson-directory"}},[t.chapterNum>0?t._l(t.item[t.slideIndex].children,(function(e,i){return s("div",{key:i,staticClass:"pd-bo"},[s("util-directory",{attrs:{util:e}}),s("lesson-directory",t._g(t._b({attrs:{lesson:e.children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)})):s("div",{staticClass:"pd-bo"},[s("lesson-directory",t._g(t._b({attrs:{lesson:t.item[t.slideIndex].children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)],2):t._e()],1):t._e(),t.nodata&&0==t.lessonNum?s("div",{staticClass:"noneItem"},[s("img",{staticClass:"nodata",attrs:{src:"static/images/none.png"}}),s("p",[t._v("暂时还没有课程哦...")])]):t._e()])}),[],!1,null,null,null).exports,$=s("326d"),L=s("2095"),F=s("4928");function A(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function H(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?A(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):A(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var M={inheritAttrs:!0,props:{details:{type:Object,value:function(){}}},data:function(){return{headBottom:0,active:1,scrollFlag:!1,tabs:["课程介绍","课程目录"],tabFixed:!1,errorMsg:"",offsetTop:"",offsetHeight:"",isFixed:!1,courseSettings:{},isShowForm:!1,paramsList:{action:"buy_after",targetType:"course",targetId:this.details.id},show:!1,show_course_review:this.$store.state.goods.show_course_review,assistantShow:!1}},mixins:[L.a],computed:H(H(H({},Object(u.e)("course",{selectedPlanId:function(t){return t.selectedPlanId},currentJoin:function(t){return t.currentJoin}})),Object(u.e)(["user"])),{},{progress:function(){return Number(this.details.publishedTaskNum)?parseInt(this.details.progress.percent)+"%":"0%"},summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)},currentTypeText:function(){return this.details.classroom?"班级":"课程"},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}}),watch:{selectedPlanId:function(t,e){this.active=1},currentJoin:{handler:function(t,e){var s=this;t&&(i.a.loading({duration:0,message:"加载中...",forbidClick:!0}),this.getInfoCollectionEvent(this.paramsList).then((function(t){if(Object.keys(t).length)return s.userInfoCollect=t,void s.getInfoCollectionForm(t.id).then((function(t){s.isShowForm=!0,i.a.clear()}));i.a.clear()})))},immediate:!0},$route:function(t,e){this.resetFrom()}},mounted:function(){window.addEventListener("scroll",this.handleScroll),this.$nextTick((function(){var t=document.getElementById("course-detail__head").offsetHeight;this.offsetTop=t+46,this.offsetHeight=44}))},created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.showDialog(),e.next=3,h.a.getSettings({query:{type:"course"}}).catch((function(t){}));case 3:t.courseSettings=e.sent;case 4:case"end":return e.stop()}}),e)})))()},components:{Directory:o.a,DetailHead:c.a,DetailPlan:g,Teacher:y,afterjoinDirectory:N,infoCollection:F.a,Reviews:$.a},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:H(H({},Object(u.d)("course",{setCurrentJoin:T.q})),{},{gotoGoodsPage:function(){this.$router.push({path:"/goods/".concat(this.details.goodsId,"/show"),query:{targetId:this.details.id}})},showDialog:function(){if(this.details.member){var t="";if(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t){this.errorMsg=this.getErrorMsg(t);var e="",s=function(){};if("course.expired"===t||"member.expired"===t&&!this.isClassCourse){e="课程已到期，无法继续学习，是否退出";var n={id:this.details.id};return s=function(){h.a.deleteCourse({query:n}).then((function(t){t.success?window.location.reload():i.a.fail("退出课程失败，请稍后重试")}))},void this.callConfirm(e,s)}var a=this.details.vipLevel?this.details.vipLevel.name:"",r={"vip.member_expired":{message:"您的会员已到期，会员".concat(this.currentTypeText,"已无法学习，请续费会员，或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"续费会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.not_member":{message:"您不是".concat(a,"，请购买").concat(a,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_low":{message:"您不是".concat(a,"，请购买").concat(a,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_not_exist":{message:"您不是".concat(a,"，请购买").concat(a,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.vip_right_not_exist":{message:"很抱歉，该".concat(this.currentTypeText,"已不属于会员权益，请退出后重新购买。"),showConfirmButton:!1,cancelButtonText:"退出".concat(this.currentTypeText)}};r[t]?this.vipCallConfirm(r[t]):i.a.fail(this.errorMsg)}}},getErrorMsg:function(t){switch(t){case"course.not_found":return"当前课程不存在";case"course.unpublished":return"当前课程未发布";case"course.expired":return"当前课程已过期";case"course.not_arrive":return"当前课程还不能学习";case"user.not_login":return"用户未登录";case"user.locked":return"用户被锁定";case"member.not_found":return"用户未加入课程";case"member.expired":return"课程已过期";case"vip.vip_closed":return"网校已关闭会员功能";case"vip.not_login":return"用户未登录";case"vip.not_member":return"当前用户并不是vip";case"vip.member_expired":return"用户会员服务已过期";case"vip.level_not_exist":return"用户会员等级或课程会员不存在";case"vip.level_low":return"用户会员等级过低";default:return"异常错误"}},callConfirm:function(t,e){a.a.confirm({message:t,title:""}).then((function(){e()})).catch((function(){}))},vipCallConfirm:function(t){this.show=!0,a.a.confirm(H(H({},t),{},{title:"",confirmButtonColor:"#1895E7",cancelButtonColor:"#FD4852",messageAlign:"left",overlay:!1,beforeClose:this.beforeClose}))},clickCloseOverlay:function(){this.show=!1,a.a.close()},beforeClose:function(t,e){if("confirm"===t)return this.$router.push({path:"/vip",query:{id:this.details.vipLevel.id}}),void e();this.show&&("班级"==this.currentTypeText?this.deleteClassroom(e):this.deleteCourse(e))},deleteClassroom:function(t){var e=this,s=this.details.classroom,i=s.id,n=s.goodsId,a={id:i};h.a.deleteClassroom({query:a}).then((function(s){s.success&&(e.$router.replace({path:"/goods/".concat(n,"/show"),query:{backUrl:"/"}}),t())}))},deleteCourse:function(t){var e=this,s=this.details,i=s.id,n=s.goodsId,a={id:i};h.a.deleteCourse({query:a}).then((function(s){s.success&&(e.$router.replace({path:"/goods/".concat(n,"/show"),query:{targetId:i}}),t())}))},handleScroll:function(){var t=document.getElementById("swiper-directory"),e=document.documentElement.scrollHeight,s=document.documentElement.clientHeight;(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)>this.offsetTop&&e-this.offsetTop>s?(this.tabFixed=!0,t&&t.classList.add("swiper-directory-fix")):(this.tabFixed=!1,t&&t.classList.remove("swiper-directory-fix"))},onCancelForm:function(){this.setCurrentJoin(!1),this.isShowForm=!1},showAssistant:function(){this.assistantShow=!0}})},B=Object(v.a)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"join-after"},[s("detail-head",{attrs:{"course-set":t.details.courseSet}}),s("van-tabs",{ref:"tabs",class:t.tabFixed?"isFixed":"",attrs:{id:"tabs"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(t){return s("van-tab",{key:t,attrs:{title:t}})})),1),s("div",{staticClass:"join-after__content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.active,expression:"active == 1"}]},[s("div",{class:["progress-bar",t.tabFixed?"progress-bar-fix":""],attrs:{id:"progress-bar"}},[s("div",{staticClass:"progress-bar__content"},[s("div",{staticClass:"progress-bar__rate",style:{width:t.progress}})]),s("div",{staticClass:"progress-bar__text"},[t._v(t._s(t.progress))])]),t.details.assistant.weChatQrCode?s("div",{staticClass:"assistant-show clearfix"},[s("div",{staticClass:"assistant-show__text",on:{click:t.showAssistant}},[s("i",{staticClass:"iconfont icon-weixin1"}),s("span",{staticClass:"text"},[t._v("\n            为了更好的学习，点击此处添加助教微信\n          ")]),s("van-icon",{staticClass:"arrow-icon",attrs:{name:"arrow"}})],1),s("van-popup",{staticClass:"assistant-show__content",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.assistantShow,callback:function(e){t.assistantShow=e},expression:"assistantShow"}},[s("img",{staticClass:"avatar",attrs:{src:t.details.assistant.avatar.middle,alt:"助教图片"}}),s("p",{staticClass:"name"},[t._v("\n            "+t._s(t.details.assistant.nickname)+"\n          ")]),s("p",{staticClass:"text"},[t._v("请务必添加助教老师微信，否则无法上课哦~")]),s("img",{staticClass:"wechat",attrs:{src:t.details.assistant.weChatQrCode,alt:"二维码图片"}}),t.isWeixin?s("div",{staticClass:"tips"},[t._v("\n            长按图片识别二维码\n          ")]):s("div",{staticClass:"tips"},[t._v("\n            长按图片保存二维码，前往微信添加\n          ")])])],1):t._e(),s("afterjoin-directory",{attrs:{"error-msg":t.errorMsg},on:{showDialog:t.showDialog}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.active,expression:"active == 0"}]},[s("detail-plan",{on:{switchPlan:t.showDialog}}),s("div",{staticClass:"segmentation"}),s("e-panel",{attrs:{title:"课程介绍"}},[s("div",{domProps:{innerHTML:t._s(t.summary)}})]),s("div",{staticClass:"segmentation"}),s("teacher",{staticClass:"teacher",attrs:{"teacher-info":t.details.teachers}}),s("div",{staticClass:"segmentation"}),1==t.show_course_review?s("reviews",{attrs:{details:t.details}}):t._e(),s("div",{staticClass:"segmentation"}),s("div",{staticClass:"segmentation"}),s("div",{staticClass:"segmentation"})],1)]),s("van-action-sheet",{staticClass:"minHeight50",attrs:{title:t.userInfoCollectForm.formTitle,"close-on-click-overlay":!1,"safe-area-inset-bottom":!0},on:{cancel:t.onCancelForm},model:{value:t.isShowForm,callback:function(e){t.isShowForm=e},expression:"isShowForm"}},[s("info-collection",{attrs:{userInfoCollectForm:t.userInfoCollectForm,formRule:t.userInfoCollectForm.items},on:{submitForm:t.onCancelForm}})],1),0==t.active&&this.details.goodsId?s("e-footer",{nativeOn:{click:function(e){return t.gotoGoodsPage(e)}}},[t._v("\n    去商品页\n  ")]):t._e(),s("van-overlay",{attrs:{show:t.show,"z-index":"1000"},on:{click:t.clickCloseOverlay}})],1)}),[],!1,null,null,null).exports,q=s("86ee"),R=s("d0b2"),J=s("49a2"),U=s("8b9d"),z=s("a262");function W(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function G(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?W(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var Q={name:"JoinBefore",components:{Teacher:y,Directory:o.a,DetailHead:c.a,DetailPlan:g,moreMask:q.a,reviewList:R.a,onsale:J.a,infoCollection:F.a},mixins:[k.a,U.a,z.a,L.a],data:function(){return{tabs:["课程介绍","课程目录","学员评价"],loadMoreAbout:!1,active:0,tabsClass:"",learnExpiry:"长期有效",startDateStr:"",endDateStr:"",tops:{aboutTop:0,courseTop:0,reviewTop:0},isEmpty:!0,unreceivedCoupons:[],miniCoupons:[],marketingActivities:{seckill:{}},courseSettings:{},isShowForm:!1,paramsList:{}}},watch:{$route:function(t,e){this.resetFrom()}},created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getSettings({query:{type:"course"}}).catch((function(t){}));case 2:t.courseSettings=e.sent;case 3:case"end":return e.stop()}}),e)})))()},computed:G(G(G({},Object(u.e)(["couponSwitch","user"])),Object(u.e)("course",{details:function(t){return t.details}})),{},{summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)},accessToJoin:function(){return"success"===this.details.access.code||"user.not_login"===this.details.access.code},vipAccessToJoin:function(){var t=!1;return!(!this.details.vipLevel||!this.user.vip)&&(this.details.vipLevel.seq<=this.user.vip.seq&&(t=!(new Date(this.user.vip.deadline).getTime()<(new Date).getTime())),t)},showOnsale:function(){return!this.isClassCourse&&0!==Number(this.details.price)&&!!(this.unreceivedCoupons.length||Object.keys(this.marketingActivities).length&&!this.onlySeckill)},onlySeckill:function(){return 1===Object.keys(this.marketingActivities).length&&this.marketingActivities.seckill},seckillStatus:function(){var t=this.marketingActivities.seckill;return Object(d.dateTimeDown)(new Date(t.endTime).getTime())},showSeckill:function(){var t=this.marketingActivities.seckill;return!this.isClassCourse&&0!==Number(this.details.price)&&t&&"ongoing"==t.status&&!this.isEmpty}}),mounted:function(){var t=this;!this.isClassCourse&&this.couponSwitch&&(h.a.searchCoupon({params:{targetId:this.details.courseSet.id,targetType:"course"}}).then((function(e){t.unreceivedCoupons=e.data,t.miniCoupons=t.unreceivedCoupons.length>3?t.unreceivedCoupons.slice(0,4):t.unreceivedCoupons})).catch((function(t){})),h.a.coursesActivities({query:{id:this.details.id}}).then((function(e){t.marketingActivities=e,t.isEmpty=!e.seckill||!+e.seckill.productRemaind})).catch((function(t){}))),window.addEventListener("touchmove",this.handleScroll),window.addEventListener("scroll",this.handleScroll),setTimeout((function(){window.scrollTo(0,0)}),100)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll),window.removeEventListener("scroll",this.handleScroll)},methods:G(G({},Object(u.c)("course",["joinCourse","getAfterCourse"])),{},{onTabClick:function(t,e){var s=this.$refs[this.transIndex2Tab(t)];window.scrollTo(0,s.$el.offsetTop-44)},transIndex2Tab:function(t){return["about","directory","review"][t]},handleScroll:function(){var t=this;if(!this.scrollFlag){this.scrollFlag=!0;var e=this.$refs,s=["about","directory","review"].reverse();setTimeout((function(){Object.keys(e).forEach((function(s){e[s]&&(t.tops["".concat(s,"Top")]=e[s].$el.getBoundingClientRect().top)})),t.scrollFlag=!1,t.tabsClass=t.tops.aboutTop-44<=0?"van-tabs--fixed":"";for(var i=0;i<s.length;i++)if(t.tops["".concat(s[i],"Top")]-44<=0)return void(t.active=s.length-i-1)}),400)}},activeCurrentTab:function(t){var e=this.tops;return(t+=44)<e.teacherTop?0:t>=e.directoryTop?2:1},handleJoin:function(){var t=this.vipAccessToJoin;if(this.accessToJoin||t)if(this.$store.state.token){var e=this.details.learningExpiryDate.expiryEndDate,s=new Date(e).getTime(),i=(new Date).getTime(),n=i<s;if(n=0==e||i<s,Number(this.details.buyable)&&n||t){if(+this.details.price&&!t)return void this.getOrder();this.collectUseInfoEvent()}}else this.$router.push({name:"login",query:{redirect:this.redirect}});else this.$toast("禁止加入")},joinFreeCourse:function(){var t=this;this.joinCourse({id:this.details.id}).then((function(e){i.a.clear(),0!==Object.keys(e).length||t.getOrder()})).catch((function(t){}))},getAfCourse:function(t){this.getAfterCourse({courseId:t}).then((function(){})).catch((function(t){i.a.fail(t.message)}))},getLearnExpiry:function(t){this.learnExpiry=t.val,this.startDateStr=t.startDateStr,this.endDateStr=t.endDateStr},switchPlan:function(){var t=this;this.marketingActivities={},h.a.coursesActivities({query:{id:this.details.id}}).then((function(e){t.marketingActivities=e})).catch((function(t){}))},getOrder:function(){var t=this.details.learningExpiryDate.expiryMode,e="".concat(this.startDateStr," 至 ").concat(this.endDateStr),s="date"===t?e:this.learnExpiry;this.$router.push({name:"order",params:{id:this.details.id},query:{expiryScope:s,targetType:"course"}})},sellOut:function(){this.isEmpty=!0},getParamsList:function(){this.paramsList={action:"buy_before",targetType:"course",targetId:this.details.id}},collectUseInfoEvent:function(){var t=this;this.hasUserInfoCollectForm?this.isShowForm=!0:(i.a.loading({duration:0,message:"加载中...",forbidClick:!0}),this.getParamsList(),this.getInfoCollectionEvent(this.paramsList).then((function(e){if(Object.keys(e).length)return t.userInfoCollect=e,void t.getInfoCollectionForm(e.id).then((function(e){t.isShowForm=!0,i.a.clear()}));t.joinFreeCourse()})))}})},V=Object(v.a)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.isClassCourse?"":"join-before"},[s("detail-head",{attrs:{price:t.details.price,"course-set":t.details.courseSet,"seckill-activities":t.marketingActivities.seckill},on:{goodsEmpty:t.sellOut}}),s("detail-plan",{on:{getLearnExpiry:t.getLearnExpiry,switchPlan:t.switchPlan}}),s("div",{staticClass:"segmentation"}),t.showOnsale?[s("onsale",{attrs:{"unreceived-coupons":t.unreceivedCoupons,"mini-coupons":t.miniCoupons,activities:t.marketingActivities}}),s("div",{staticClass:"segmentation"})]:t._e(),s("van-tabs",{class:t.tabsClass,on:{click:t.onTabClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(t){return s("van-tab",{key:t,attrs:{title:t}})})),1),s("e-panel",{ref:"about",staticClass:"about",attrs:{title:"课程介绍"}},[s("more-mask",{attrs:{disabled:t.loadMoreAbout},on:{maskLoadMore:function(e){t.loadMoreAbout=!0}}},[s("div",{domProps:{innerHTML:t._s(t.summary)}})])],1),s("div",{staticClass:"segmentation"}),s("teacher",{staticClass:"teacher",attrs:{"teacher-info":t.details.teachers,title:"教师介绍"}}),s("div",{staticClass:"segmentation"}),s("directory",{ref:"directory"}),s("div",{staticClass:"segmentation"}),s("review-list",{ref:"review",attrs:{"target-id":t.details.courseSet.id,reviews:1==t.courseSettings.show_review?t.details.reviews:[],title:"学员评价",type:"course","defaul-value":"暂无评价"}}),s("van-action-sheet",{staticClass:"minHeight50",attrs:{title:t.userInfoCollectForm.formTitle,"close-on-click-overlay":!1,"safe-area-inset-bottom":!0},model:{value:t.isShowForm,callback:function(e){t.isShowForm=e},expression:"isShowForm"}},[s("info-collection",{attrs:{userInfoCollectForm:t.userInfoCollectForm,formRule:t.userInfoCollectForm.items},on:{submitForm:t.joinFreeCourse}})],1),t.isClassCourse||t.marketingActivities.seckill&&(!t.marketingActivities.seckill||!t.isEmpty&&"已到期"!==t.seckillStatus)&&0!=t.details.price?t._e():s("e-footer",{attrs:{disabled:!t.accessToJoin},nativeOn:{click:function(e){return t.handleJoin(e)}}},[t._v("\n    "+t._s(t._f("filterJoinStatus")(t.details.access.code,"course",t.vipAccessToJoin)))]),t.showSeckill&&"已到期"!==t.seckillStatus?s("div",[s("e-footer",{attrs:{disabled:!t.accessToJoin,half:"true"},nativeOn:{click:function(e){return t.handleJoin(e)}}},[t._v(t._s(t._f("filterJoinStatus")(t.details.access.code,"course",t.vipAccessToJoin)))]),s("e-footer",{attrs:{half:"true"},nativeOn:{click:function(e){return t.activityHandle(t.marketingActivities.seckill.id)}}},[t._v("去秒杀")])],1):t._e()],2)}),[],!1,null,null,null).exports;function Y(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function K(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(s),!0).forEach((function(e){Object(n.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Y(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var X={components:{},inject:["reload"],data:function(){return{currentComp:""}},computed:K(K({},Object(u.e)("course",{selectedPlanIndex:function(t){return t.selectedPlanIndex},joinStatus:function(t){return t.joinStatus},details:function(t){return t.details},selectedPlanId:function(t){return t.selectedPlanId}})),Object(u.e)({isLoading:function(t){return t.isLoading}})),watch:{joinStatus:{handler:"joinStatusChange"},$route:function(t,e){this.getData()}},created:function(){this.getData()},methods:K(K(K({},Object(u.c)("course",["getCourseLessons"])),Object(u.d)("course",{setSourceType:T.x})),{},{getData:function(){var t=this;this.getCourseLessons({courseId:this.$route.params.id}).then((function(e){e.member||Number(t.details.parentId)?t.joinStatusChange(e.member):t.$router.push({path:"/goods/".concat(e.goodsId,"/show")})}))},joinStatusChange:function(t){this.currentComp="",this.currentComp=t?B:V},getJoinAfter:function(){this.getJoinAfterDetail({courseId:this.$route.params.id}).then((function(t){})).catch((function(t){i.a.fail(t.message)}))}}),beforeRouteLeave:function(t,e,s){this.setSourceType({sourceType:"img",taskId:0}),s()}},Z=Object(v.a)(X,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"course-detail"},[this.isLoading?e("e-loading"):this._e(),e(this.currentComp,{tag:"component",attrs:{details:this.details}})],1)}),[],!1,null,null,null);e.default=Z.exports}}]);