!function(l){function t(t){for(var e,n,i=t[0],o=t[1],r=t[2],a=0,s=[];a<i.length;a++)n=i[a],Object.prototype.hasOwnProperty.call(u,n)&&u[n]&&s.push(u[n][0]),u[n]=0;for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&(l[e]=o[e]);for(h&&h(t);s.length;)s.shift()();return c.push.apply(c,r||[]),d()}function d(){for(var t,e=0;e<c.length;e++){for(var n=c[e],i=!0,o=1;o<n.length;o++){var r=n[o];0!==u[r]&&(i=!1)}i&&(c.splice(e--,1),t=a(a.s=n[0]))}return t}var n={},u={33:0},c=[];function a(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return l[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=l,a.c=n,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/static-dist/";var e=window.webpackJsonp=window.webpackJsonp||[],i=e.push.bind(e);e.push=t,e=e.slice();for(var o=0;o<e.length;o++)t(e[o]);var h=i;c.push([724,0]),d()}({10:function(t,e){t.exports=jQuery},724:function(t,e,n){"use strict";n.r(e);var i=n(68),o=n(0),r=n.n(o),a=n(1),s=n.n(a),l=n(5),d=n(93),u=function(){function n(t,e){r()(this,n),this.$form=t,this.$modal=e,this.initEvent()}return s()(n,[{key:"initEvent",value:function(){var e=this;this.$form.on("click",'[data-role="item-delete-btn"]',function(t){return e.deleteQuestion(t)}),this.$form.on("click",'[data-role="replace-item"]',function(t){return e.replaceQuestion(t)}),this.$form.on("click",'[data-role="preview-btn"]',function(t){return e.previewQuestion(t)}),this.$form.on("click",'[data-role="batch-delete-btn"]',function(t){return e.batchDelete(t)}),this.initSortList()}},{key:"initSortList",value:function(){var r,o=this,t=this.$form.find("tbody"),e=t.hasClass("js-homework-table")?"":"<td></td>",n='<tr class="question-placehoder js-placehoder"><td></td><td></td><td></td><td></td><td></td><td></td><td></td>'.concat(e,"</tr>");t.sortable({containerPath:"> tr",containerSelector:"tbody",itemSelector:"tr.is-question",placeholder:n,exclude:".notMoveHandle",onDragStart:function(t,e,n){t.hasClass("have-sub-questions")||$(".js-have-sub").removeClass("is-question");var i=t.offset(),o=e.rootGroup.pointer;r={left:o.left-i.left,top:o.top-i.top},n(t,e)},onDrag:function(t,e){var n=t.height();t.css({left:e.left-r.left,top:e.top-r.top}),$(".js-placehoder").css({height:n})},onDrop:function(t,e,n){if(n(t,e),t.hasClass("have-sub-questions")){var i=t.parents("tbody");i.find("tr.is-question").each(function(){var t=$(this);i.find("[data-parent-id="+t.data("id")+"]").detach().insertAfter(t)})}else $(".js-have-sub").addClass("is-question");o.refreshSeqs()}})}},{key:"replaceQuestion",value:function(t){var e=this,n=$(t.currentTarget),i=[],o=this.$form.find("tbody:visible");o.find('[name="questionIds[]"]').each(function(){i.push($(this).val())}),this.$modal.data("manager",this).modal(),$.get(n.data("url"),{excludeIds:i.join(","),type:o.data("type")},function(t){e.$modal.html(t)})}},{key:"deleteQuestion",value:function(t){t.stopPropagation();var e=$(t.currentTarget),n=e.closest("tr").data("id"),i=e.closest("tbody");i.find('[data-parent-id="'+n+'"]').remove(),e.closest("tr").remove(),Object(d.a)(this.$form),i.trigger("lengthChange"),this.refreshSeqs()}},{key:"batchDelete",value:function(){if(0==this.$form.find('[data-role="batch-item"]:checked').length){var t=this.$form.find(".js-help-redmine");t?(t.text(Translator.trans("activity.testpaper_manage.question_required_error_hint")).show(),setTimeout(function(){t.slideUp()},3e3)):Object(l.a)("danger",Translator.trans("activity.testpaper_manage.question_required_error_hint"))}var i=this;this.$form.find('[data-role="batch-item"]:checked').each(function(t,e){var n=$(this).val();"material"==$(this).closest("tr").data("type")&&i.$form.find('[data-parent-id="'+n+'"]').remove(),$(this).closest("tr").remove()}),this.refreshSeqs(),Object(d.a)(this.$form)}},{key:"previewQuestion",value:function(t){t.preventDefault(),window.open($(t.currentTarget).data("url"),"_blank","directories=0,height=580,width=820,scrollbars=1,toolbar=0,status=0,menubar=0,location=0")}},{key:"refreshSeqs",value:function(){var e=1;this.$form.find("tbody tr").each(function(){var t=$(this);t.hasClass("have-sub-questions")||(t.find("td.seq").html(e),e++)}),this.$form.find('[name="questionLength"]').val(0<e-1?e-1:null)}}]),n}(),c=function(){function e(t){r()(this,e),this.$homeworkModal=$("#modal",window.parent.document),this.$questionPickedModal=$("#attachment-modal",window.parent.document),this.$element=t,this.$step2_form=this.$element.find("#step2-form"),this.$step3_form=this.$element.find("#step3-form"),this.validator2=null,this.init()}return s()(e,[{key:"init",value:function(){this.initEvent(),this.setValidateRule(),this.inItStep2form()}},{key:"initEvent",value:function(){var e=this;this.$element.on("click",'[data-role="pick-item"]',function(t){return e.showPickQuestion(t)}),this.$questionPickedModal.on("shown.bs.modal",function(){e.$homeworkModal.hide()}),this.$questionPickedModal.on("hidden.bs.modal",function(){e.$homeworkModal.show(),e.$questionPickedModal.html(""),e.validator2&&e.validator2.form()})}},{key:"initCkeditor",value:function(t){var e=CKEDITOR.replace("homework-about-field",{toolbar:"Task",fileSingleSizeLimit:app.fileSingleSizeLimit,filebrowserImageUploadUrl:$("#homework-about-field").data("imageUploadUrl")});e.on("change",function(){$("#homework-about-field").val(e.getData())}),e.on("blur",function(){t.form()})}},{key:"showPickQuestion",value:function(t){var e=this;t.preventDefault();var n=$(t.currentTarget),i=[];$("#question-table-tbody").find('[name="questionIds[]"]').each(function(){i.push($(this).val())}),this.$questionPickedModal.modal().data("manager",this),$.get(n.data("url"),{excludeIds:i.join(",")},function(t){e.$questionPickedModal.html(t)})}},{key:"inItStep2form",value:function(){var t=this.$step2_form.validate({onkeyup:!1,rules:{title:{required:!0,maxlength:50,trim:!0,course_title:!0},description:{required:!0},content:"required",questionLength:{required:!0}},messages:{description:Translator.trans("activity.homework_manage.question_homework_hint"),questionLength:Translator.trans("activity.homework_manage.question_required_error_hint")}});this.validator2=t,this.initCkeditor(t),this.$step2_form.data("validator",t)}},{key:"setValidateRule",value:function(){$.validator.addMethod("arithmeticFloat",function(t,e){return this.optional(e)||/^[0-9]+(\.[0-9]?)?$/.test(t)},$.validator.format(Translator.trans("activity.homework_manage.arithmetic_float_error_hint"))),$.validator.addMethod("positiveInteger",function(t,e){return this.optional(e)||/^[1-9]\d*$/.test(t)},$.validator.format(Translator.trans("activity.homework_manage.positive_integer_error_hint"))),$.validator.addMethod("DateAndTime",function(t,e){return this.optional(e)||/^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29) ([0-1]{1}[0-9]{1})|(2[0-4]{1}):[0-5]{1}[0-9]{1}$/.test(t)},$.validator.format(Translator.trans("activity.homework_manage.date_and_time_error_hint:mm")))}}]),e}(),h=$("#step2-form");new c($("#iframe-content")),new i.a(h),new u(h,$("#attachment-modal",window.parent.document))},93:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(t){var e=!1,n="",i=$("#task-create-content-iframe").contents().find(".js-subjective-remask");t.find("tbody tr").each(function(){var t=$(this).data("type");console.log(t),"essay"==t&&(e=!0)}),console.log(e),e||0==t.find("tbody tr").length?i.html(""):(console.log(i),n="homework"==i.data("type")?Translator.trans("activity.homework_manage.objective_question_hint"):Translator.trans("activity.homework_manage.pass_objective_question_hint"),i.html(n).removeClass("hidden"))}}});